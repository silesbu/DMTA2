<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Statistics with R</title>
  <meta name="description" content="Syllabus for the course ‘Statistics with R’">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Syllabus for the course ‘Statistics with R’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistics with R" />
  
  <meta name="twitter:description" content="Syllabus for the course ‘Statistics with R’" />
  

<meta name="author" content="Douwe Molenaar">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="datafabrication.html">
<link rel="next" href="bias-metabolomics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script language="javascript">
  function toggle(showHideDiv, switchTextDiv) {
  	var ele = document.getElementById(showHideDiv);
	  var text = document.getElementById(switchTextDiv);
	  if(ele.style.display == "block") {
	  	ele.style.display = "none";
	  	text.innerHTML = "Show solution";
	  }
	  else {
	  	ele.style.display = "block";
      text.innerHTML = "Hide solution";
	  }
  }
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="styles/style.css" type="text/css" />
<link rel="stylesheet" href="styles/block_elements.css" type="text/css" />
<link rel="stylesheet" href="styles/localadapt.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="1" data-path="studyguide.html"><a href="studyguide.html"><i class="fa fa-check"></i><b>1</b> Study guide</a><ul>
<li class="chapter" data-level="1.1" data-path="studyguide.html"><a href="studyguide.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="studyguide.html"><a href="studyguide.html#entry-conditions"><i class="fa fa-check"></i><b>1.2</b> Entry conditions</a></li>
<li class="chapter" data-level="1.3" data-path="studyguide.html"><a href="studyguide.html#goal-of-the-course"><i class="fa fa-check"></i><b>1.3</b> Goal of the course</a><ul>
<li class="chapter" data-level="1.3.1" data-path="studyguide.html"><a href="studyguide.html#this-is-not-a-statistics-course"><i class="fa fa-check"></i><b>1.3.1</b> This is not a statistics course</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="studyguide.html"><a href="studyguide.html#workload"><i class="fa fa-check"></i><b>1.4</b> Workload</a></li>
<li class="chapter" data-level="1.5" data-path="studyguide.html"><a href="studyguide.html#setup-and-content-of-the-course"><i class="fa fa-check"></i><b>1.5</b> Setup and content of the course</a><ul>
<li class="chapter" data-level="1.5.1" data-path="studyguide.html"><a href="studyguide.html#walk-in-hours"><i class="fa fa-check"></i><b>1.5.1</b> Walk-in hours</a></li>
<li class="chapter" data-level="1.5.2" data-path="studyguide.html"><a href="studyguide.html#syllabus"><i class="fa fa-check"></i><b>1.5.2</b> Syllabus</a></li>
<li class="chapter" data-level="1.5.3" data-path="studyguide.html"><a href="studyguide.html#assignments"><i class="fa fa-check"></i><b>1.5.3</b> Assignments</a></li>
<li class="chapter" data-level="1.5.4" data-path="studyguide.html"><a href="studyguide.html#assessment"><i class="fa fa-check"></i><b>1.5.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5.5" data-path="studyguide.html"><a href="studyguide.html#evaluation-of-the-course"><i class="fa fa-check"></i><b>1.5.5</b> Evaluation of the course</a></li>
<li class="chapter" data-level="1.5.6" data-path="studyguide.html"><a href="studyguide.html#course-schedule"><i class="fa fa-check"></i><b>1.5.6</b> Course schedule</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Technical background</b></span></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> A quick start</a><ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#resources-for-learning-r"><i class="fa fa-check"></i><b>2.2</b> Resources for learning R</a></li>
<li class="chapter" data-level="2.3" data-path="quick-start.html"><a href="quick-start.html#other-sources-on-the-use-of-r"><i class="fa fa-check"></i><b>2.3</b> Other sources on the use of R</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start.html"><a href="quick-start.html#installation-of-r"><i class="fa fa-check"></i><b>2.4</b> Installation of R</a></li>
<li class="chapter" data-level="2.5" data-path="quick-start.html"><a href="quick-start.html#starting-r"><i class="fa fa-check"></i><b>2.5</b> Starting R</a></li>
<li class="chapter" data-level="2.6" data-path="quick-start.html"><a href="quick-start.html#obtaining-help"><i class="fa fa-check"></i><b>2.6</b> Obtaining help</a></li>
<li class="chapter" data-level="2.7" data-path="quick-start.html"><a href="quick-start.html#an-r-session"><i class="fa fa-check"></i><b>2.7</b> An R-session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html"><i class="fa fa-check"></i><b>3</b> Elementary data types and operations</a><ul>
<li class="chapter" data-level="3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-atomic-data-types"><i class="fa fa-check"></i><b>3.1</b> The atomic data types</a></li>
<li class="chapter" data-level="3.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-basic-data-object-classes"><i class="fa fa-check"></i><b>3.2</b> The basic data object classes</a></li>
<li class="chapter" data-level="3.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#assigning-names-to-r-objects"><i class="fa fa-check"></i><b>3.3</b> Assigning names to R-objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#listing-objects-in-memory"><i class="fa fa-check"></i><b>3.3.1</b> Listing objects in memory</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#arithmetic-with-vectors-arrays-and-data-frames"><i class="fa fa-check"></i><b>3.4</b> Arithmetic with vectors, arrays, and data frames</a></li>
<li class="chapter" data-level="3.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-and-replacing-parts-of-data-objects"><i class="fa fa-check"></i><b>3.5</b> Extracting and replacing parts of data objects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-a-single-sub-object-with-the-double-bracket-index-selector"><i class="fa fa-check"></i><b>3.5.1</b> Extracting a single sub-object with the double bracket index selector <code>[[</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#for-data-frames-and-lists-and-selectors-behave-similarly"><i class="fa fa-check"></i><b>3.5.2</b> For data frames and lists <code>$</code> and <code>[[</code> selectors behave similarly</a></li>
<li class="chapter" data-level="3.5.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#complement-syntax"><i class="fa fa-check"></i><b>3.5.3</b> Selecting portions with the single bracket selector <code>[</code></a></li>
<li class="chapter" data-level="3.5.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#changing-parts-of-a-vector"><i class="fa fa-check"></i><b>3.5.4</b> Changing parts of a vector</a></li>
<li class="chapter" data-level="3.5.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-data-frames"><i class="fa fa-check"></i><b>3.5.5</b> Effect of the selector operators on data frames</a></li>
<li class="chapter" data-level="3.5.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-arrays"><i class="fa fa-check"></i><b>3.5.6</b> Effect of the selector operators on arrays</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#removingelements"><i class="fa fa-check"></i><b>3.6</b> Removing elements from objects</a></li>
<li class="chapter" data-level="3.7" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#coercion"><i class="fa fa-check"></i><b>3.7</b> Data class conversion or coercion</a></li>
<li class="chapter" data-level="3.8" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#selection"><i class="fa fa-check"></i>Selection</a></li>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#more-selection-vectors-and-sequences"><i class="fa fa-check"></i>More selection, vectors and sequences</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interacting-with-r.html"><a href="interacting-with-r.html"><i class="fa fa-check"></i><b>4</b> Interacting with R</a><ul>
<li class="chapter" data-level="4.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#controlling-r-from-a-script"><i class="fa fa-check"></i><b>4.1</b> Controlling R from a script</a></li>
<li class="chapter" data-level="4.2" data-path="interacting-with-r.html"><a href="interacting-with-r.html#other-editors"><i class="fa fa-check"></i><b>4.2</b> Other editors</a></li>
<li class="chapter" data-level="4.3" data-path="interacting-with-r.html"><a href="interacting-with-r.html#working-with-packages"><i class="fa fa-check"></i><b>4.3</b> Working with packages</a></li>
<li class="chapter" data-level="4.4" data-path="interacting-with-r.html"><a href="interacting-with-r.html#where-your-packages-are-installed"><i class="fa fa-check"></i><b>4.4</b> Where your packages are installed</a></li>
<li class="chapter" data-level="4.5" data-path="interacting-with-r.html"><a href="interacting-with-r.html#reproducible-research"><i class="fa fa-check"></i><b>4.5</b> Reproducible research</a><ul>
<li class="chapter" data-level="4.5.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#staying-organized"><i class="fa fa-check"></i><b>4.5.1</b> Staying organized</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="interacting-with-r.html"><a href="interacting-with-r.html#easy-organizing"><i class="fa fa-check"></i><b>4.6</b> Easy organizing with RStudio</a><ul>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#rmarkdown-documents"><i class="fa fa-check"></i>Rmarkdown documents</a></li>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#externalizing-code"><i class="fa fa-check"></i>Externalizing code</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="interacting-with-r.html"><a href="interacting-with-r.html#displaying-information-about-your-r-session"><i class="fa fa-check"></i><b>4.7</b> Displaying information about your R session</a></li>
<li class="chapter" data-level="4.8" data-path="interacting-with-r.html"><a href="interacting-with-r.html#citing-r-and-r-packages-in-reports-and-papers"><i class="fa fa-check"></i><b>4.8</b> Citing R and R-packages in reports and papers</a></li>
<li class="chapter" data-level="4.9" data-path="interacting-with-r.html"><a href="interacting-with-r.html#exercise-diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i><b>4.9</b> Exercise: diversity of deep-sea nematodes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#the-basics-of-r-graphics"><i class="fa fa-check"></i><b>5.1</b> The basics of R graphics</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#x-y-plots"><i class="fa fa-check"></i><b>5.2</b> X-Y plots</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>5.3</b> Histograms</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>5.4</b> Boxplots</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#images-and-contour-plots"><i class="fa fa-check"></i><b>5.5</b> Images and contour plots</a></li>
<li class="chapter" data-level="5.6" data-path="graphics.html"><a href="graphics.html#plotting-a-mathematical-function"><i class="fa fa-check"></i><b>5.6</b> Plotting a mathematical function</a></li>
<li class="chapter" data-level="5.7" data-path="graphics.html"><a href="graphics.html#multiple-figures-in-one-graphical-device"><i class="fa fa-check"></i><b>5.7</b> Multiple figures in one graphical device</a></li>
<li class="chapter" data-level="5.8" data-path="graphics.html"><a href="graphics.html#saving-graphs"><i class="fa fa-check"></i><b>5.8</b> Saving graphs</a></li>
<li class="chapter" data-level="5.9" data-path="graphics.html"><a href="graphics.html#graphical-systems"><i class="fa fa-check"></i><b>5.9</b> Different graphical systems and packages</a></li>
<li class="chapter" data-level="5.10" data-path="graphics.html"><a href="graphics.html#exercises-1"><i class="fa fa-check"></i><b>5.10</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#simple-curves"><i class="fa fa-check"></i>Simple curves</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#human-population-growth"><i class="fa fa-check"></i>Human population growth</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#toxic-ammonia"><i class="fa fa-check"></i>Toxic ammonia</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#the-iris-data-set"><i class="fa fa-check"></i>The iris data set</a></li>
<li><a href="graphics.html#automatic-coercion-by-plot">Automatic coercion by <code>plot()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="file-io.html"><a href="file-io.html"><i class="fa fa-check"></i><b>6</b> File input and output</a><ul>
<li class="chapter" data-level="6.1" data-path="file-io.html"><a href="file-io.html#defining-the-path-to-a-file-or-directory"><i class="fa fa-check"></i><b>6.1</b> Defining the path to a file or directory</a></li>
<li class="chapter" data-level="6.2" data-path="file-io.html"><a href="file-io.html#the-working-directory"><i class="fa fa-check"></i><b>6.2</b> The “working directory”</a></li>
<li class="chapter" data-level="6.3" data-path="file-io.html"><a href="file-io.html#using-the-read.table-and-write.table-functions"><i class="fa fa-check"></i><b>6.3</b> Using the <code>read.table</code> and <code>write.table</code> functions</a></li>
<li class="chapter" data-level="6.4" data-path="file-io.html"><a href="file-io.html#reading-data-from-a-webserver"><i class="fa fa-check"></i><b>6.4</b> Reading data from a webserver</a></li>
<li class="chapter" data-level="6.5" data-path="file-io.html"><a href="file-io.html#reading-data-from-compressed-files-and-archives"><i class="fa fa-check"></i><b>6.5</b> Reading data from compressed files and archives</a></li>
<li class="chapter" data-level="6.6" data-path="file-io.html"><a href="file-io.html#inputoutput-with-excel-files-and-database-management-systems"><i class="fa fa-check"></i><b>6.6</b> Input/output with Excel files and database management systems</a></li>
<li class="chapter" data-level="6.7" data-path="file-io.html"><a href="file-io.html#exercises-2"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Programming-with-R.html"><a href="Programming-with-R.html"><i class="fa fa-check"></i><b>7</b> Programming with R</a><ul>
<li class="chapter" data-level="7.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#defining-a-function"><i class="fa fa-check"></i><b>7.1</b> Defining a function</a></li>
<li class="chapter" data-level="7.2" data-path="Programming-with-R.html"><a href="Programming-with-R.html#program-flow-control"><i class="fa fa-check"></i><b>7.2</b> Program flow control</a></li>
<li class="chapter" data-level="7.3" data-path="Programming-with-R.html"><a href="Programming-with-R.html#literature"><i class="fa fa-check"></i><b>7.3</b> Literature</a></li>
<li class="chapter" data-level="7.4" data-path="Programming-with-R.html"><a href="Programming-with-R.html#exercises-3"><i class="fa fa-check"></i><b>7.4</b> Exercises</a><ul>
<li class="chapter" data-level="7.4.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#programming-loops"><i class="fa fa-check"></i><b>7.4.1</b> Loops</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i>Diversity of deep-sea nematodes</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-indices-a-function-optional"><i class="fa fa-check"></i>Diversity indices – a function (optional)</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#rarefaction-diversity-optional"><i class="fa fa-check"></i>Rarefaction diversity (optional)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Programming-with-R.html"><a href="Programming-with-R.html#add-prog-ex"><i class="fa fa-check"></i><b>7.5</b> Additional programming exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>8</b> Vectorization</a><ul>
<li class="chapter" data-level="8.1" data-path="vectorization.html"><a href="vectorization.html#the-function-apply"><i class="fa fa-check"></i><b>8.1</b> The function <code>apply()</code></a></li>
<li class="chapter" data-level="8.2" data-path="vectorization.html"><a href="vectorization.html#the-function-tapply"><i class="fa fa-check"></i><b>8.2</b> The function <code id="the-function-tapply">tapply()</code></a></li>
<li class="chapter" data-level="8.3" data-path="vectorization.html"><a href="vectorization.html#the-functions-lapply-and-sapply"><i class="fa fa-check"></i><b>8.3</b> The functions <code>lapply()</code> and <code>sapply()</code></a></li>
<li class="chapter" data-level="8.4" data-path="vectorization.html"><a href="vectorization.html#exercises-4"><i class="fa fa-check"></i><b>8.4</b> Exercises</a><ul>
<li class="chapter" data-level="8.4.1" data-path="vectorization.html"><a href="vectorization.html#permutation-function"><i class="fa fa-check"></i><b>8.4.1</b> A permutation function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>9</b> Reshaping and manipulating complex data</a><ul>
<li class="chapter" data-level="9.1" data-path="reshaping.html"><a href="reshaping.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.1</b> The <code>tidyr</code> package</a></li>
<li class="chapter" data-level="9.2" data-path="reshaping.html"><a href="reshaping.html#the-dplyr-package"><i class="fa fa-check"></i><b>9.2</b> The <code>dplyr</code> package</a></li>
<li class="chapter" data-level="9.3" data-path="reshaping.html"><a href="reshaping.html#exercises-5"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="formulasyntax.html"><a href="formulasyntax.html"><i class="fa fa-check"></i><b>10</b> Using formula syntax</a><ul>
<li class="chapter" data-level="10.1" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-plotting"><i class="fa fa-check"></i><b>10.1</b> Using formula syntax in plotting</a></li>
<li class="chapter" data-level="10.2" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-model-definition"><i class="fa fa-check"></i><b>10.2</b> Using formula syntax in model definition</a><ul>
<li class="chapter" data-level="10.2.1" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-a-continuous-explanatory-variable"><i class="fa fa-check"></i><b>10.2.1</b> Data with a continuous explanatory variable</a></li>
<li class="chapter" data-level="10.2.2" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-two-discrete-explanatory-variables-factors"><i class="fa fa-check"></i><b>10.2.2</b> Data with two discrete explanatory variables (factors)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Applications</b></span></li>
<li class="chapter" data-level="11" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>11</b> The carnival of distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="distributions.html"><a href="distributions.html#distribution-functions"><i class="fa fa-check"></i><b>11.1</b> Distribution functions</a></li>
<li class="chapter" data-level="11.2" data-path="distributions.html"><a href="distributions.html#distribution-functions-in-r"><i class="fa fa-check"></i><b>11.2</b> Distribution functions in R</a></li>
<li class="chapter" data-level="11.3" data-path="distributions.html"><a href="distributions.html#the-exponential-and-poisson-distributions"><i class="fa fa-check"></i><b>11.3</b> The exponential and Poisson distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="distributions.html"><a href="distributions.html#the-bernoulli-and-binomial-distributions"><i class="fa fa-check"></i><b>11.4</b> The Bernoulli and binomial distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="distributions.html"><a href="distributions.html#the-normal-and-standard-normal-distribution"><i class="fa fa-check"></i><b>11.5</b> The normal and standard normal distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="distributions.html"><a href="distributions.html#students-t-distribution"><i class="fa fa-check"></i><b>11.6</b> Student’s t-distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="distributions.html"><a href="distributions.html#the-chi-squared-distribution"><i class="fa fa-check"></i><b>11.7</b> The chi-squared distribution</a><ul>
<li class="chapter" data-level="11.7.1" data-path="distributions.html"><a href="distributions.html#application-in-pearsons-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>11.7.1</b> Application in Pearson’s chi-square goodness of fit test</a></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-2"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="distributions.html"><a href="distributions.html#the-f-distribution"><i class="fa fa-check"></i><b>11.8</b> The F-distribution</a><ul>
<li class="chapter" data-level="11.8.1" data-path="distributions.html"><a href="distributions.html#analysis-of-variance"><i class="fa fa-check"></i><b>11.8.1</b> Analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linearmodels.html"><a href="linearmodels.html"><i class="fa fa-check"></i><b>12</b> Linear models and ANOVA</a><ul>
<li class="chapter" data-level="12.1" data-path="linearmodels.html"><a href="linearmodels.html#modeling-with-factor-type-predictor-variables"><i class="fa fa-check"></i><b>12.1</b> Modeling with factor-type predictor variables</a><ul>
<li class="chapter" data-level="12.1.1" data-path="linearmodels.html"><a href="linearmodels.html#alternative-dummy-variable-coding-schemes"><i class="fa fa-check"></i><b>12.1.1</b> Alternative dummy variable coding schemes</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-8"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="linearmodels.html"><a href="linearmodels.html#two-way-anovafactorial-anova"><i class="fa fa-check"></i><b>12.2</b> Two-way ANOVA/factorial ANOVA</a><ul>
<li class="chapter" data-level="12.2.1" data-path="linearmodels.html"><a href="linearmodels.html#unbalanced-data"><i class="fa fa-check"></i><b>12.2.1</b> Unbalanced data</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercise-5"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linearmodels.html"><a href="linearmodels.html#combinations-of-numerical-and-discrete-predictors"><i class="fa fa-check"></i><b>12.3</b> Combinations of numerical and discrete predictors</a><ul>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-9"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linearmodels.html"><a href="linearmodels.html#the-connection-between-linear-models-and-anova"><i class="fa fa-check"></i><b>12.4</b> The connection between linear models and ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hubble.html"><a href="hubble.html"><i class="fa fa-check"></i><b>13</b> The age of the universe</a><ul>
<li class="chapter" data-level="13.1" data-path="hubble.html"><a href="hubble.html#exercises-10"><i class="fa fa-check"></i><b>13.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="datafabrication.html"><a href="datafabrication.html"><i class="fa fa-check"></i><b>14</b> A case of data fabrication</a><ul>
<li class="chapter" data-level="14.1" data-path="datafabrication.html"><a href="datafabrication.html#exercises-11"><i class="fa fa-check"></i><b>14.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="amt-carrier.html"><a href="amt-carrier.html"><i class="fa fa-check"></i><b>15</b> A critical evaluation of ammonium transporter kinetics</a><ul>
<li class="chapter" data-level="15.1" data-path="amt-carrier.html"><a href="amt-carrier.html#exercises-12"><i class="fa fa-check"></i><b>15.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html"><i class="fa fa-check"></i><b>16</b> Bias in metabolomics data</a><ul>
<li class="chapter" data-level="16.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#exercises-13"><i class="fa fa-check"></i><b>16.1</b> Exercises</a><ul>
<li class="chapter" data-level="16.1.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#an-alternative-solution-generalized-additive-modeling-optional"><i class="fa fa-check"></i><b>16.1.1</b> An alternative solution: Generalized additive modeling (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="nerve-fiber.html"><a href="nerve-fiber.html"><i class="fa fa-check"></i><b>17</b> Correlation between fiber density and episodic memory?</a><ul>
<li class="chapter" data-level="17.1" data-path="nerve-fiber.html"><a href="nerve-fiber.html#exercises-14"><i class="fa fa-check"></i><b>17.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="classifiers.html"><a href="classifiers.html"><i class="fa fa-check"></i><b>18</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.1" data-path="classifiers.html"><a href="classifiers.html#classifiers"><i class="fa fa-check"></i><b>18.1</b> Classifiers</a></li>
<li class="chapter" data-level="18.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression"><i class="fa fa-check"></i><b>18.2</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.2.1" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-a-case-of-generalized-linear-modeling"><i class="fa fa-check"></i><b>18.2.1</b> Logistic Regression: a case of Generalized Linear Modeling</a></li>
<li class="chapter" data-level="18.2.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-in-r"><i class="fa fa-check"></i><b>18.2.2</b> Logistic regression in R</a></li>
<li class="chapter" data-level="18.2.3" data-path="classifiers.html"><a href="classifiers.html#exercises-15"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html"><i class="fa fa-check"></i><b>19</b> Classification of dairy bacteria</a><ul>
<li class="chapter" data-level="19.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#exercises-16"><i class="fa fa-check"></i><b>19.1</b> Exercises</a><ul>
<li class="chapter" data-level="19.1.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#description-of-the-data"><i class="fa fa-check"></i><b>19.1.1</b> Description of the data</a></li>
<li class="chapter" data-level="19.1.2" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-conversion"><i class="fa fa-check"></i><b>19.1.2</b> Data conversion</a></li>
<li class="chapter" data-level="19.1.3" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-analysis"><i class="fa fa-check"></i><b>19.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="naivebayes.html"><a href="naivebayes.html"><i class="fa fa-check"></i><b>20</b> Naïve Bayes classifiers</a><ul>
<li class="chapter" data-level="20.1" data-path="naivebayes.html"><a href="naivebayes.html#the-naive-bayes-classifier"><i class="fa fa-check"></i><b>20.1</b> The Naive Bayes classifier</a></li>
<li class="chapter" data-level="20.2" data-path="naivebayes.html"><a href="naivebayes.html#a-crime-scene"><i class="fa fa-check"></i><b>20.2</b> A crime scene</a></li>
<li class="chapter" data-level="20.3" data-path="naivebayes.html"><a href="naivebayes.html#reconstructing-bayes-lawtheorem"><i class="fa fa-check"></i><b>20.3</b> Reconstructing Bayes law/theorem</a></li>
<li class="chapter" data-level="20.4" data-path="naivebayes.html"><a href="naivebayes.html#deciding-on-the-class"><i class="fa fa-check"></i><b>20.4</b> Deciding on the class</a></li>
<li class="chapter" data-level="20.5" data-path="naivebayes.html"><a href="naivebayes.html#continuous-predicting-variables"><i class="fa fa-check"></i><b>20.5</b> Continuous predicting variables</a></li>
<li class="chapter" data-level="20.6" data-path="naivebayes.html"><a href="naivebayes.html#combining-information-from-different-predictor-variables"><i class="fa fa-check"></i><b>20.6</b> Combining information from different predictor variables</a></li>
<li class="chapter" data-level="20.7" data-path="naivebayes.html"><a href="naivebayes.html#exercises-17"><i class="fa fa-check"></i><b>20.7</b> Exercises</a><ul>
<li class="chapter" data-level="20.7.1" data-path="naivebayes.html"><a href="naivebayes.html#predicting-iris-species"><i class="fa fa-check"></i><b>20.7.1</b> Predicting iris species</a></li>
<li class="chapter" data-level="20.7.2" data-path="naivebayes.html"><a href="naivebayes.html#predicting-income"><i class="fa fa-check"></i><b>20.7.2</b> Predicting income</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="resampling-techniques.html"><a href="resampling-techniques.html"><i class="fa fa-check"></i><b>21</b> Resampling techniques</a><ul>
<li class="chapter" data-level="21.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#bootstrapping"><i class="fa fa-check"></i><b>21.1</b> Bootstrapping</a></li>
<li class="chapter" data-level="21.2" data-path="resampling-techniques.html"><a href="resampling-techniques.html#exercises-18"><i class="fa fa-check"></i><b>21.2</b> Exercises</a><ul>
<li class="chapter" data-level="21.2.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#medical-patches"><i class="fa fa-check"></i><b>21.2.1</b> Medical patches</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="resampling-techniques.html"><a href="resampling-techniques.html#permutation-test"><i class="fa fa-check"></i><b>21.3</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html"><i class="fa fa-check"></i><b>22</b> Numerical differentiation and smoothing</a><ul>
<li class="chapter" data-level="22.1" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#exercises-19"><i class="fa fa-check"></i><b>22.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="randomnumbers.html"><a href="randomnumbers.html"><i class="fa fa-check"></i><b>23</b> Random numbers</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="amt-carrier" class="section level1">
<h1><span class="header-section-number">CHAPTER 15</span> A critical evaluation of ammonium transporter kinetics</h1>
<p><strong>(Techniques: nonlinear fitting)</strong></p>
<p>The water soluble gas ammonia (NH<span class="math inline">\(_{3}\)</span>) is thought to diffuse easily through lipid membranes. Hence, at high ammonia concentrations this passive diffusion is more than sufficient to provide the cell with the nitrogen that it uses for protein and nucleotide biosynthesis <span class="citation">(Boogerd et al. <a href="#ref-Boogerd2011">2011</a>)</span>. However, at low ammonia concentrations active, energy-driven, transport of ammonia or ammonium is necessary. <span class="citation">Khademi et al. (<a href="#ref-Khademi2004">2004</a>)</span> crystallized and characterized such a carrier from <em>E. coli</em>, called AmtB. According to their hypothesis, the carrier facilitates the passive diffusion of ammonia. They performed experiments with purified carrier reconstituted in lipid vesicles made from purified lipids. According to <span class="citation">Khademi et al. (<a href="#ref-Khademi2004">2004</a>)</span> the carrier led to a tenfold increase in the diffusion rate of ammonia, from 12.8 +/- 0.7 s<sup>-1</sup> in vesicles without carrier to 115.6 +/- 13.2 s<sup>-1</sup> in vesicles with carrier. The authors stated that these measurements were performed in six-fold. The measurements were performed with a fluorescent pH indicator present in the vesicles. Due to the influx of ammonia and the subsequent equilibration of ammonia with the ammonium species (<span class="math inline">\(pK_{A}\approx9.0\)</span>) the proton concentration inside the vesicles decreases, and this gives an increase in the fluorescence. Their figure 5A displayed the data from a “typical experiment”.</p>
<div class="figure"><span id="fig:fig5AKhademi"></span>
<img src="images/Khademi_fig5A.png" alt="A copy of Figure 5A from @Khademi2004" width="50%" />
<p class="caption">
Figure 15.1: A copy of Figure 5A from <span class="citation">Khademi et al. (<a href="#ref-Khademi2004">2004</a>)</span>
</p>
</div>
<p>We would like to check their assertion. Hence, I reconstructed the fluorescence data from their figure with the freely available tool ScanIt<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a> and put those on the server (<a href="data/Amt_carrier_kinetics/Khademi2004_Fig5A.txt">data/Amt_carrier_kinetics/Khademi2004_Fig5A.txt</a>). The file contains data in tab-delimited form including a header. The factor column called “expt” indicates whether the data were from the control experiment concerning vesicles without carrier, or from the experiment using vesicles with carrier.</p>
<div id="exercises-12" class="section level2">
<h2><span class="header-section-number">15.1</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Load and plot the data in R. Use different symbols for the different experiments. Check the <a href="https://cran.r-project.org/doc/contrib/Baggott-refcard-v2.pdf">reference card</a> to choose a nice set of symbols.
<div>
<a id="AmtcarrierHead1" href="javascript:toggle('AmtcarrierSol1','AmtcarrierHead1');" >Show solution</a>
</div>
<div id="AmtcarrierSol1" style="display: none">
<p>Loading and plotting the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">file.path</span>(baseurl, <span class="st">&#39;data/Amt_carrier_kinetics/Khademi2004_Fig5A.txt&#39;</span>)
d &lt;-<span class="st"> </span><span class="kw">read.table</span>(f, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">head=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(fluorescence<span class="op">~</span>time, <span class="dt">data=</span>d, <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)[d<span class="op">$</span>expt])</code></pre></div>
<p><img src="StatR_files/figure-html/amtkinet_01-1.png" width="672" /></p>
</div></li>
</ol>
<p>Although <em>it was not explicitly stated</em> in the paper, the most likely model to which the data were fitted is an inverted exponential decay curve. These are of the form</p>
<p><span class="math display">\[
F(t)=F_{max}(1-e^{-kt})
\]</span></p>
<p>where <span class="math inline">\(F(t)\)</span> is the fluorescence at time <span class="math inline">\(t\)</span>, <span class="math inline">\(F_{max}\)</span> is the final maximal fluorescence, and <span class="math inline">\(k\)</span> is the first order decay constant. Notice that <span class="math inline">\(\left(\frac{dF(t)}{dt}\right)_{t=0}=kF_{max}\)</span>, and hence the initial slopes, are proportional to <span class="math inline">\(k\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>For the control experiment and the carrier experiment make fits of the data to this inverted exponential decay models. Use the non-linear least squares function <code>nls()</code> from the standard <code>stats</code> package (which is already loaded at start-up) for this. First read its help page. Why is this called non-linear fitting? You will have to give initial estimates of the parameters (<span class="math inline">\(F_{max}\)</span> and <span class="math inline">\(k\)</span>) to get convergence of the nls fitting algorithm. These have to be entered to the “start” argument as a <code>list</code> object containing the exact names of the parameters as in the formula. So, for example, <code>start=list(Fmax=1, k=10)</code>. You can estimate start values for the parameters from the graphs. Also, do not forget to select the proper rows from the data frame corresponding to either the control or the carrier vesicles. You can do that in the conventional way by using the <code>[</code> selector operator, or by using the <code>subset</code> argument of the <code>nls()</code> function. Print the <code>nls</code> objects to the screen and interpret the output. Also try a few different starting values for the parameters. Does the outcome of the fit differ, or the number of iterations used?
<div>
<a id="AmtcarrierHead2" href="javascript:toggle('AmtcarrierSol2','AmtcarrierHead2');" >Show solution</a>
</div>
<div id="AmtcarrierSol2" style="display: none">
<p>We make a non-linear fit of the exponential decay equation using the function <code>nls()</code>. The fitting is no-linear because the parameter <span class="math inline">\(k\)</span> to be fitted appears in the equation in a non-linear fashion. Displaying the fits yields:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">controlfit &lt;-<span class="st"> </span><span class="kw">nls</span>(fluorescence<span class="op">~</span>Fmax<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>time)), <span class="dt">data=</span>d, <span class="dt">start=</span><span class="kw">list</span>(<span class="dt">Fmax=</span><span class="dv">1</span>, <span class="dt">k=</span><span class="dv">10</span>), <span class="dt">subset=</span>d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;control&#39;</span>)
carrierfit &lt;-<span class="st"> </span><span class="kw">nls</span>(fluorescence<span class="op">~</span>Fmax<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>time)), <span class="dt">data=</span>d, <span class="dt">start=</span><span class="kw">list</span>(<span class="dt">Fmax=</span><span class="dv">1</span>, <span class="dt">k=</span><span class="dv">20</span>), <span class="dt">subset=</span>d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>)
controlfit</code></pre></div>
<pre><code>## Nonlinear regression model
##   model: fluorescence ~ Fmax * (1 - exp(-k * time))
##    data: d
##    Fmax       k 
##  0.9552 11.1905 
##  residual sum-of-squares: 0.004535
## 
## Number of iterations to convergence: 4 
## Achieved convergence tolerance: 8.714e-08</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">carrierfit</code></pre></div>
<pre><code>## Nonlinear regression model
##   model: fluorescence ~ Fmax * (1 - exp(-k * time))
##    data: d
##    Fmax       k 
##  0.9413 28.1820 
##  residual sum-of-squares: 0.08918
## 
## Number of iterations to convergence: 7 
## Achieved convergence tolerance: 9.992e-06</code></pre>
<p>The number of iterations until convergence may differ when using different starting conditions.</p>
</div></li>
<li>Plot the lines of the fits in the figure with the data. Use the <code>predict()</code> method for <code>nls</code> class objects.
<div>
<a id="AmtcarrierHead3" href="javascript:toggle('AmtcarrierSol3','AmtcarrierHead3');" >Show solution</a>
</div>
<div id="AmtcarrierSol3" style="display: none">
<p>Plotting the fitted curves with the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fluorescence<span class="op">~</span>time, <span class="dt">data=</span>d, <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)[d<span class="op">$</span>expt])
<span class="kw">lines</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;control&#39;</span>], <span class="kw">predict</span>(controlfit), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">lines</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>], <span class="kw">predict</span>(carrierfit), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/amtkinet_03-1.png" width="672" /></p>
</div></li>
<li>Do the fitted first order decay constants agree with those reported by the authors?
<div>
<a id="AmtcarrierHead4" href="javascript:toggle('AmtcarrierSol4','AmtcarrierHead4');" >Show solution</a>
</div>
<div id="AmtcarrierSol4" style="display: none">
<p>For the control vesicles the fitted rate constant <span class="math inline">\(k\)</span> roughly agrees with that of the paper, but for the carrier vesicles the fitted <span class="math inline">\(k\)</span> is much lower than the reported <span class="math inline">\(k\)</span>.</p>
</div></li>
<li>Compare your curve for the carrier vesicles with the one from the paper. Do you notice a difference? Make a residual plot (use the <code>residuals()</code> method for <code>nls</code> objects) against time for your fit of the control and carrier vesicles. Do you notice a trend in any of them? If so, what does this indicate?
<div>
<a id="AmtcarrierHead5" href="javascript:toggle('AmtcarrierSol5','AmtcarrierHead5');" >Show solution</a>
</div>
<div id="AmtcarrierSol5" style="display: none">
<p>The main difference seems to appear at the beginning of the curve, where data points are initially located above the fit and then mainly below the fit. A residual plot also shows this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">1</span>))
<span class="kw">plot</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;control&#39;</span>], <span class="kw">residuals</span>(controlfit), <span class="dt">xlab=</span><span class="st">&#39;time&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;residuals&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Residuals control fit&#39;</span>)
<span class="kw">plot</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>], <span class="kw">residuals</span>(carrierfit), <span class="dt">xlab=</span><span class="st">&#39;time&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;residuals&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Residuals carrier fit&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/amtkinet_04-1.png" width="0.8\linewidth" /></p>
</div></li>
</ol>
<p>Your first order constant for the carrier vesicles probably doesn’t agree with that of the authors. Furthermore, it appears as if the authors used a different fitting function for their carrier vesicles experiment. Thinking about it: the ammonia diffusion process in these vesicles probably consists of a mixture of two processes, namely a passive and a carrier-mediated diffusion. Both are likely to be first order processes, specifically also the carrier-mediated process, since the <span class="math inline">\(K_{M}\)</span> of the carrier, estimated in other experiments, is much higher than the concentration used in this experiment.</p>
<ol start="6" style="list-style-type: decimal">
<li>Formulate a mathematical model, just as the one above, that describes the combined behavior of both processes.
<div>
<a id="AmtcarrierHead6" href="javascript:toggle('AmtcarrierSol6','AmtcarrierHead6');" >Show solution</a>
</div>
<div id="AmtcarrierSol6" style="display: none">
<p>A bi-exponential decay model could be used. It consists of the sum of two exponential decay models with possibly different <span class="math inline">\(F_{max}\)</span>’s and certainly different values for the decay constants <span class="math inline">\(k\)</span>:</p>
<p><span class="math display">\[
F(t)=F_{max1}(1-e^{-k_{1}t})+F_{max2}(1-e^{-k_{2}t})
\]</span></p>
<p>Of course, <span class="math inline">\(F_{max1}+F_{max2}\)</span> has to add up to the total fluorescence present at the end of the experiment.</p>
</div></li>
<li>Fit your model to the carrier vesicle data. In general: the more parameters you are fitting, the better initial estimates you will have to give, so do that carefully.
<div>
<a id="AmtcarrierHead7" href="javascript:toggle('AmtcarrierSol7','AmtcarrierHead7');" >Show solution</a>
</div>
<div id="AmtcarrierSol7" style="display: none">
<p>We try to provide good initial estimates of the parameters. For the slow process we use the <span class="math inline">\(k\)</span>-value estimated earlier. For the fast process we start with an arbitrary higher value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">carrierfit2 &lt;-<span class="st"> </span><span class="kw">nls</span>(fluorescence <span class="op">~</span><span class="st"> </span>Fmax1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>k1<span class="op">*</span>time)) <span class="op">+</span><span class="st"> </span>Fmax2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>k2<span class="op">*</span>time)), <span class="dt">data=</span>d, ,<span class="dt">subset=</span>d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>, <span class="dt">start=</span><span class="kw">list</span>(<span class="dt">Fmax1=</span><span class="fl">0.5</span>, <span class="dt">Fmax2=</span><span class="fl">0.5</span>, <span class="dt">k1=</span><span class="dv">11</span>, <span class="dt">k2=</span><span class="dv">40</span>))
carrierfit2</code></pre></div>
<pre><code>## Nonlinear regression model
##   model: fluorescence ~ Fmax1 * (1 - exp(-k1 * time)) + Fmax2 * (1 - exp(-k2 *     time))
##    data: d
##   Fmax1   Fmax2      k1      k2 
##  0.4676  0.4964 13.6617 64.6515 
##  residual sum-of-squares: 0.03784
## 
## Number of iterations to convergence: 7 
## Achieved convergence tolerance: 3.275e-06</code></pre>
</div></li>
<li>Do your parameter estimates agree with those of the authors now? Provide some hypotheses for discrepancies between your result and those of the authors.
<div>
<a id="AmtcarrierHead8" href="javascript:toggle('AmtcarrierSol8','AmtcarrierHead8');" >Show solution</a>
</div>
<div id="AmtcarrierSol8" style="display: none">
<p>The fast process still has an approximately two-fold lower rate than that reported in the paper. Perhaps the bi-exponential model still does not fit the data well. However, plotting the fit and the residuals shows that it is a good model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">1</span>))
<span class="kw">plot</span>(fluorescence<span class="op">~</span>time, <span class="dt">data=</span>d, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">subset=</span>d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Bi-exponential fit&#39;</span>)
<span class="kw">lines</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>], <span class="kw">predict</span>(carrierfit2), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(d<span class="op">$</span>time[d<span class="op">$</span>expt<span class="op">==</span><span class="st">&#39;carrier&#39;</span>], <span class="kw">residuals</span>(carrierfit2), <span class="dt">xlab=</span><span class="st">&#39;time&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;residuals&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Residuals&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/amtkinet_06-1.png" width="0.8\linewidth" /> Perhaps then, the estimation of this fast process is very sensitive to the data (<em>i.e.</em>, the error in the estimate is large). Printing the summary of the fit, however, shows no exceptionally high estimated standard deviation for <span class="math inline">\(k2\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(carrierfit2)</code></pre></div>
<pre><code>## 
## Formula: fluorescence ~ Fmax1 * (1 - exp(-k1 * time)) + Fmax2 * (1 - exp(-k2 * 
##     time))
## 
## Parameters:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Fmax1  0.46761    0.06599   7.086 7.22e-10 ***
## Fmax2  0.49639    0.06882   7.212 4.20e-10 ***
## k1    13.66167    1.69721   8.049 1.14e-11 ***
## k2    64.65152   10.34699   6.248 2.49e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.02277 on 73 degrees of freedom
## 
## Number of iterations to convergence: 7 
## Achieved convergence tolerance: 3.275e-06</code></pre>
</div></li>
<li>One hypothesis to explain this controversy is that the experiment from Figure 5A was not so “typical” but rather an outlier. Considering the reported standard deviation of the first order rate constant of carrier mediated diffusion, is it likely that the experiment from figure 5 was an outlier?
<div>
<a id="AmtcarrierHead9" href="javascript:toggle('AmtcarrierSol9','AmtcarrierHead9');" >Show solution</a>
</div>
<div id="AmtcarrierSol9" style="display: none">
<p>No this is very unlikely, given the fact that the reported standard deviation equals only 10% of the estimated rate constant.</p>
</div></li>
</ol>
<p>This demonstrates how bad it is not to provide <em>exact descriptions of experimental as well as data analysis procedures</em>. It is actually visible from the figure that the speed up of transport is less than 10-fold, and the reviewers of the paper have not paid enough attention.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Boogerd2011">
<p>Boogerd, F. C., H. Ma, F. J. Bruggeman, W. C. Van Heeswijk, R. García-Contreras, D. Molenaar, K. Krab, and H. V. Westerhoff. 2011. “AmtB-Mediated NH<span class="math inline">\(_{3}\)</span> Transport in Prokaryotes Must Be Active and as a Consequence Regulation of Transport by GlnK Is Mandatory to Limit Futile Cycling of NH<span class="math inline">\(_{4}^{+}\)</span>/NH<span class="math inline">\(_{3} .\)</span>” <em>FEBS Lett.</em> 585: 23–28. doi:<a href="https://doi.org/10.1016/j.febslet.2010.11.055">10.1016/j.febslet.2010.11.055</a>.</p>
</div>
<div id="ref-Khademi2004">
<p>Khademi, S., J. O’Connell, J. Remis, Y. Robles-Colmenares, L. J. W. Miercke, and R. M. Stroud. 2004. “Mechanism of Ammonia Transport by Amt/MEP/Rh: Structure of AmtB at 1.35 A.” <em>Science</em> 305 (5690): 1587–94. doi:<a href="https://doi.org/10.1126/science.1101952">10.1126/science.1101952</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>See the Amsterchem website <a href="http://www.amsterchem.com/scanit.html" class="uri">http://www.amsterchem.com/scanit.html</a>. Only for MS-Windows, unfortunately.<a href="amt-carrier.html#fnref9">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datafabrication.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bias-metabolomics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "libs/mathjax-local/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
