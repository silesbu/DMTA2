<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Statistics with R</title>
  <meta name="description" content="Syllabus for the course ‘Statistics with R’">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Syllabus for the course ‘Statistics with R’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistics with R" />
  
  <meta name="twitter:description" content="Syllabus for the course ‘Statistics with R’" />
  

<meta name="author" content="Douwe Molenaar">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="Programming-with-R.html">
<link rel="next" href="reshaping.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script language="javascript">
  function toggle(showHideDiv, switchTextDiv) {
  	var ele = document.getElementById(showHideDiv);
	  var text = document.getElementById(switchTextDiv);
	  if(ele.style.display == "block") {
	  	ele.style.display = "none";
	  	text.innerHTML = "Show solution";
	  }
	  else {
	  	ele.style.display = "block";
      text.innerHTML = "Hide solution";
	  }
  }
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="styles/style.css" type="text/css" />
<link rel="stylesheet" href="styles/block_elements.css" type="text/css" />
<link rel="stylesheet" href="styles/localadapt.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="1" data-path="studyguide.html"><a href="studyguide.html"><i class="fa fa-check"></i><b>1</b> Study guide</a><ul>
<li class="chapter" data-level="1.1" data-path="studyguide.html"><a href="studyguide.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="studyguide.html"><a href="studyguide.html#entry-conditions"><i class="fa fa-check"></i><b>1.2</b> Entry conditions</a></li>
<li class="chapter" data-level="1.3" data-path="studyguide.html"><a href="studyguide.html#goal-of-the-course"><i class="fa fa-check"></i><b>1.3</b> Goal of the course</a><ul>
<li class="chapter" data-level="1.3.1" data-path="studyguide.html"><a href="studyguide.html#this-is-not-a-statistics-course"><i class="fa fa-check"></i><b>1.3.1</b> This is not a statistics course</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="studyguide.html"><a href="studyguide.html#workload"><i class="fa fa-check"></i><b>1.4</b> Workload</a></li>
<li class="chapter" data-level="1.5" data-path="studyguide.html"><a href="studyguide.html#setup-and-content-of-the-course"><i class="fa fa-check"></i><b>1.5</b> Setup and content of the course</a><ul>
<li class="chapter" data-level="1.5.1" data-path="studyguide.html"><a href="studyguide.html#walk-in-hours"><i class="fa fa-check"></i><b>1.5.1</b> Walk-in hours</a></li>
<li class="chapter" data-level="1.5.2" data-path="studyguide.html"><a href="studyguide.html#syllabus"><i class="fa fa-check"></i><b>1.5.2</b> Syllabus</a></li>
<li class="chapter" data-level="1.5.3" data-path="studyguide.html"><a href="studyguide.html#assignments"><i class="fa fa-check"></i><b>1.5.3</b> Assignments</a></li>
<li class="chapter" data-level="1.5.4" data-path="studyguide.html"><a href="studyguide.html#assessment"><i class="fa fa-check"></i><b>1.5.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5.5" data-path="studyguide.html"><a href="studyguide.html#evaluation-of-the-course"><i class="fa fa-check"></i><b>1.5.5</b> Evaluation of the course</a></li>
<li class="chapter" data-level="1.5.6" data-path="studyguide.html"><a href="studyguide.html#course-schedule"><i class="fa fa-check"></i><b>1.5.6</b> Course schedule</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Technical background</b></span></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> A quick start</a><ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#resources-for-learning-r"><i class="fa fa-check"></i><b>2.2</b> Resources for learning R</a></li>
<li class="chapter" data-level="2.3" data-path="quick-start.html"><a href="quick-start.html#other-sources-on-the-use-of-r"><i class="fa fa-check"></i><b>2.3</b> Other sources on the use of R</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start.html"><a href="quick-start.html#installation-of-r"><i class="fa fa-check"></i><b>2.4</b> Installation of R</a></li>
<li class="chapter" data-level="2.5" data-path="quick-start.html"><a href="quick-start.html#starting-r"><i class="fa fa-check"></i><b>2.5</b> Starting R</a></li>
<li class="chapter" data-level="2.6" data-path="quick-start.html"><a href="quick-start.html#obtaining-help"><i class="fa fa-check"></i><b>2.6</b> Obtaining help</a></li>
<li class="chapter" data-level="2.7" data-path="quick-start.html"><a href="quick-start.html#an-r-session"><i class="fa fa-check"></i><b>2.7</b> An R-session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html"><i class="fa fa-check"></i><b>3</b> Elementary data types and operations</a><ul>
<li class="chapter" data-level="3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-atomic-data-types"><i class="fa fa-check"></i><b>3.1</b> The atomic data types</a></li>
<li class="chapter" data-level="3.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-basic-data-object-classes"><i class="fa fa-check"></i><b>3.2</b> The basic data object classes</a></li>
<li class="chapter" data-level="3.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#assigning-names-to-r-objects"><i class="fa fa-check"></i><b>3.3</b> Assigning names to R-objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#listing-objects-in-memory"><i class="fa fa-check"></i><b>3.3.1</b> Listing objects in memory</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#arithmetic-with-vectors-arrays-and-data-frames"><i class="fa fa-check"></i><b>3.4</b> Arithmetic with vectors, arrays, and data frames</a></li>
<li class="chapter" data-level="3.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-and-replacing-parts-of-data-objects"><i class="fa fa-check"></i><b>3.5</b> Extracting and replacing parts of data objects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-a-single-sub-object-with-the-double-bracket-index-selector"><i class="fa fa-check"></i><b>3.5.1</b> Extracting a single sub-object with the double bracket index selector <code>[[</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#for-data-frames-and-lists-and-selectors-behave-similarly"><i class="fa fa-check"></i><b>3.5.2</b> For data frames and lists <code>$</code> and <code>[[</code> selectors behave similarly</a></li>
<li class="chapter" data-level="3.5.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#complement-syntax"><i class="fa fa-check"></i><b>3.5.3</b> Selecting portions with the single bracket selector <code>[</code></a></li>
<li class="chapter" data-level="3.5.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#changing-parts-of-a-vector"><i class="fa fa-check"></i><b>3.5.4</b> Changing parts of a vector</a></li>
<li class="chapter" data-level="3.5.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-data-frames"><i class="fa fa-check"></i><b>3.5.5</b> Effect of the selector operators on data frames</a></li>
<li class="chapter" data-level="3.5.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-arrays"><i class="fa fa-check"></i><b>3.5.6</b> Effect of the selector operators on arrays</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#removingelements"><i class="fa fa-check"></i><b>3.6</b> Removing elements from objects</a></li>
<li class="chapter" data-level="3.7" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#coercion"><i class="fa fa-check"></i><b>3.7</b> Data class conversion or coercion</a></li>
<li class="chapter" data-level="3.8" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#selection"><i class="fa fa-check"></i>Selection</a></li>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#more-selection-vectors-and-sequences"><i class="fa fa-check"></i>More selection, vectors and sequences</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interacting-with-r.html"><a href="interacting-with-r.html"><i class="fa fa-check"></i><b>4</b> Interacting with R</a><ul>
<li class="chapter" data-level="4.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#controlling-r-from-a-script"><i class="fa fa-check"></i><b>4.1</b> Controlling R from a script</a></li>
<li class="chapter" data-level="4.2" data-path="interacting-with-r.html"><a href="interacting-with-r.html#other-editors"><i class="fa fa-check"></i><b>4.2</b> Other editors</a></li>
<li class="chapter" data-level="4.3" data-path="interacting-with-r.html"><a href="interacting-with-r.html#working-with-packages"><i class="fa fa-check"></i><b>4.3</b> Working with packages</a></li>
<li class="chapter" data-level="4.4" data-path="interacting-with-r.html"><a href="interacting-with-r.html#where-your-packages-are-installed"><i class="fa fa-check"></i><b>4.4</b> Where your packages are installed</a></li>
<li class="chapter" data-level="4.5" data-path="interacting-with-r.html"><a href="interacting-with-r.html#reproducible-research"><i class="fa fa-check"></i><b>4.5</b> Reproducible research</a><ul>
<li class="chapter" data-level="4.5.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#staying-organized"><i class="fa fa-check"></i><b>4.5.1</b> Staying organized</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="interacting-with-r.html"><a href="interacting-with-r.html#easy-organizing"><i class="fa fa-check"></i><b>4.6</b> Easy organizing with RStudio</a><ul>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#rmarkdown-documents"><i class="fa fa-check"></i>Rmarkdown documents</a></li>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#externalizing-code"><i class="fa fa-check"></i>Externalizing code</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="interacting-with-r.html"><a href="interacting-with-r.html#displaying-information-about-your-r-session"><i class="fa fa-check"></i><b>4.7</b> Displaying information about your R session</a></li>
<li class="chapter" data-level="4.8" data-path="interacting-with-r.html"><a href="interacting-with-r.html#citing-r-and-r-packages-in-reports-and-papers"><i class="fa fa-check"></i><b>4.8</b> Citing R and R-packages in reports and papers</a></li>
<li class="chapter" data-level="4.9" data-path="interacting-with-r.html"><a href="interacting-with-r.html#exercise-diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i><b>4.9</b> Exercise: diversity of deep-sea nematodes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#the-basics-of-r-graphics"><i class="fa fa-check"></i><b>5.1</b> The basics of R graphics</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#x-y-plots"><i class="fa fa-check"></i><b>5.2</b> X-Y plots</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>5.3</b> Histograms</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>5.4</b> Boxplots</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#images-and-contour-plots"><i class="fa fa-check"></i><b>5.5</b> Images and contour plots</a></li>
<li class="chapter" data-level="5.6" data-path="graphics.html"><a href="graphics.html#plotting-a-mathematical-function"><i class="fa fa-check"></i><b>5.6</b> Plotting a mathematical function</a></li>
<li class="chapter" data-level="5.7" data-path="graphics.html"><a href="graphics.html#multiple-figures-in-one-graphical-device"><i class="fa fa-check"></i><b>5.7</b> Multiple figures in one graphical device</a></li>
<li class="chapter" data-level="5.8" data-path="graphics.html"><a href="graphics.html#saving-graphs"><i class="fa fa-check"></i><b>5.8</b> Saving graphs</a></li>
<li class="chapter" data-level="5.9" data-path="graphics.html"><a href="graphics.html#graphical-systems"><i class="fa fa-check"></i><b>5.9</b> Different graphical systems and packages</a></li>
<li class="chapter" data-level="5.10" data-path="graphics.html"><a href="graphics.html#exercises-1"><i class="fa fa-check"></i><b>5.10</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#simple-curves"><i class="fa fa-check"></i>Simple curves</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#human-population-growth"><i class="fa fa-check"></i>Human population growth</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#toxic-ammonia"><i class="fa fa-check"></i>Toxic ammonia</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#the-iris-data-set"><i class="fa fa-check"></i>The iris data set</a></li>
<li><a href="graphics.html#automatic-coercion-by-plot">Automatic coercion by <code>plot()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="file-io.html"><a href="file-io.html"><i class="fa fa-check"></i><b>6</b> File input and output</a><ul>
<li class="chapter" data-level="6.1" data-path="file-io.html"><a href="file-io.html#defining-the-path-to-a-file-or-directory"><i class="fa fa-check"></i><b>6.1</b> Defining the path to a file or directory</a></li>
<li class="chapter" data-level="6.2" data-path="file-io.html"><a href="file-io.html#the-working-directory"><i class="fa fa-check"></i><b>6.2</b> The “working directory”</a></li>
<li class="chapter" data-level="6.3" data-path="file-io.html"><a href="file-io.html#using-the-read.table-and-write.table-functions"><i class="fa fa-check"></i><b>6.3</b> Using the <code>read.table</code> and <code>write.table</code> functions</a></li>
<li class="chapter" data-level="6.4" data-path="file-io.html"><a href="file-io.html#reading-data-from-a-webserver"><i class="fa fa-check"></i><b>6.4</b> Reading data from a webserver</a></li>
<li class="chapter" data-level="6.5" data-path="file-io.html"><a href="file-io.html#reading-data-from-compressed-files-and-archives"><i class="fa fa-check"></i><b>6.5</b> Reading data from compressed files and archives</a></li>
<li class="chapter" data-level="6.6" data-path="file-io.html"><a href="file-io.html#inputoutput-with-excel-files-and-database-management-systems"><i class="fa fa-check"></i><b>6.6</b> Input/output with Excel files and database management systems</a></li>
<li class="chapter" data-level="6.7" data-path="file-io.html"><a href="file-io.html#exercises-2"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Programming-with-R.html"><a href="Programming-with-R.html"><i class="fa fa-check"></i><b>7</b> Programming with R</a><ul>
<li class="chapter" data-level="7.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#defining-a-function"><i class="fa fa-check"></i><b>7.1</b> Defining a function</a></li>
<li class="chapter" data-level="7.2" data-path="Programming-with-R.html"><a href="Programming-with-R.html#program-flow-control"><i class="fa fa-check"></i><b>7.2</b> Program flow control</a></li>
<li class="chapter" data-level="7.3" data-path="Programming-with-R.html"><a href="Programming-with-R.html#literature"><i class="fa fa-check"></i><b>7.3</b> Literature</a></li>
<li class="chapter" data-level="7.4" data-path="Programming-with-R.html"><a href="Programming-with-R.html#exercises-3"><i class="fa fa-check"></i><b>7.4</b> Exercises</a><ul>
<li class="chapter" data-level="7.4.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#programming-loops"><i class="fa fa-check"></i><b>7.4.1</b> Loops</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i>Diversity of deep-sea nematodes</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-indices-a-function-optional"><i class="fa fa-check"></i>Diversity indices – a function (optional)</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#rarefaction-diversity-optional"><i class="fa fa-check"></i>Rarefaction diversity (optional)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Programming-with-R.html"><a href="Programming-with-R.html#add-prog-ex"><i class="fa fa-check"></i><b>7.5</b> Additional programming exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>8</b> Vectorization</a><ul>
<li class="chapter" data-level="8.1" data-path="vectorization.html"><a href="vectorization.html#the-function-apply"><i class="fa fa-check"></i><b>8.1</b> The function <code>apply()</code></a></li>
<li class="chapter" data-level="8.2" data-path="vectorization.html"><a href="vectorization.html#the-function-tapply"><i class="fa fa-check"></i><b>8.2</b> The function <code id="the-function-tapply">tapply()</code></a></li>
<li class="chapter" data-level="8.3" data-path="vectorization.html"><a href="vectorization.html#the-functions-lapply-and-sapply"><i class="fa fa-check"></i><b>8.3</b> The functions <code>lapply()</code> and <code>sapply()</code></a></li>
<li class="chapter" data-level="8.4" data-path="vectorization.html"><a href="vectorization.html#exercises-4"><i class="fa fa-check"></i><b>8.4</b> Exercises</a><ul>
<li class="chapter" data-level="8.4.1" data-path="vectorization.html"><a href="vectorization.html#permutation-function"><i class="fa fa-check"></i><b>8.4.1</b> A permutation function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>9</b> Reshaping and manipulating complex data</a><ul>
<li class="chapter" data-level="9.1" data-path="reshaping.html"><a href="reshaping.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.1</b> The <code>tidyr</code> package</a></li>
<li class="chapter" data-level="9.2" data-path="reshaping.html"><a href="reshaping.html#the-dplyr-package"><i class="fa fa-check"></i><b>9.2</b> The <code>dplyr</code> package</a></li>
<li class="chapter" data-level="9.3" data-path="reshaping.html"><a href="reshaping.html#exercises-5"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="formulasyntax.html"><a href="formulasyntax.html"><i class="fa fa-check"></i><b>10</b> Using formula syntax</a><ul>
<li class="chapter" data-level="10.1" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-plotting"><i class="fa fa-check"></i><b>10.1</b> Using formula syntax in plotting</a></li>
<li class="chapter" data-level="10.2" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-model-definition"><i class="fa fa-check"></i><b>10.2</b> Using formula syntax in model definition</a><ul>
<li class="chapter" data-level="10.2.1" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-a-continuous-explanatory-variable"><i class="fa fa-check"></i><b>10.2.1</b> Data with a continuous explanatory variable</a></li>
<li class="chapter" data-level="10.2.2" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-two-discrete-explanatory-variables-factors"><i class="fa fa-check"></i><b>10.2.2</b> Data with two discrete explanatory variables (factors)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Applications</b></span></li>
<li class="chapter" data-level="11" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>11</b> The carnival of distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="distributions.html"><a href="distributions.html#distribution-functions"><i class="fa fa-check"></i><b>11.1</b> Distribution functions</a></li>
<li class="chapter" data-level="11.2" data-path="distributions.html"><a href="distributions.html#distribution-functions-in-r"><i class="fa fa-check"></i><b>11.2</b> Distribution functions in R</a></li>
<li class="chapter" data-level="11.3" data-path="distributions.html"><a href="distributions.html#the-exponential-and-poisson-distributions"><i class="fa fa-check"></i><b>11.3</b> The exponential and Poisson distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="distributions.html"><a href="distributions.html#the-bernoulli-and-binomial-distributions"><i class="fa fa-check"></i><b>11.4</b> The Bernoulli and binomial distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="distributions.html"><a href="distributions.html#the-normal-and-standard-normal-distribution"><i class="fa fa-check"></i><b>11.5</b> The normal and standard normal distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="distributions.html"><a href="distributions.html#students-t-distribution"><i class="fa fa-check"></i><b>11.6</b> Student’s t-distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="distributions.html"><a href="distributions.html#the-chi-squared-distribution"><i class="fa fa-check"></i><b>11.7</b> The chi-squared distribution</a><ul>
<li class="chapter" data-level="11.7.1" data-path="distributions.html"><a href="distributions.html#application-in-pearsons-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>11.7.1</b> Application in Pearson’s chi-square goodness of fit test</a></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-2"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="distributions.html"><a href="distributions.html#the-f-distribution"><i class="fa fa-check"></i><b>11.8</b> The F-distribution</a><ul>
<li class="chapter" data-level="11.8.1" data-path="distributions.html"><a href="distributions.html#analysis-of-variance"><i class="fa fa-check"></i><b>11.8.1</b> Analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linearmodels.html"><a href="linearmodels.html"><i class="fa fa-check"></i><b>12</b> Linear models and ANOVA</a><ul>
<li class="chapter" data-level="12.1" data-path="linearmodels.html"><a href="linearmodels.html#modeling-with-factor-type-predictor-variables"><i class="fa fa-check"></i><b>12.1</b> Modeling with factor-type predictor variables</a><ul>
<li class="chapter" data-level="12.1.1" data-path="linearmodels.html"><a href="linearmodels.html#alternative-dummy-variable-coding-schemes"><i class="fa fa-check"></i><b>12.1.1</b> Alternative dummy variable coding schemes</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-8"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="linearmodels.html"><a href="linearmodels.html#two-way-anovafactorial-anova"><i class="fa fa-check"></i><b>12.2</b> Two-way ANOVA/factorial ANOVA</a><ul>
<li class="chapter" data-level="12.2.1" data-path="linearmodels.html"><a href="linearmodels.html#unbalanced-data"><i class="fa fa-check"></i><b>12.2.1</b> Unbalanced data</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercise-5"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linearmodels.html"><a href="linearmodels.html#combinations-of-numerical-and-discrete-predictors"><i class="fa fa-check"></i><b>12.3</b> Combinations of numerical and discrete predictors</a><ul>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-9"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linearmodels.html"><a href="linearmodels.html#the-connection-between-linear-models-and-anova"><i class="fa fa-check"></i><b>12.4</b> The connection between linear models and ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hubble.html"><a href="hubble.html"><i class="fa fa-check"></i><b>13</b> The age of the universe</a><ul>
<li class="chapter" data-level="13.1" data-path="hubble.html"><a href="hubble.html#exercises-10"><i class="fa fa-check"></i><b>13.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="datafabrication.html"><a href="datafabrication.html"><i class="fa fa-check"></i><b>14</b> A case of data fabrication</a><ul>
<li class="chapter" data-level="14.1" data-path="datafabrication.html"><a href="datafabrication.html#exercises-11"><i class="fa fa-check"></i><b>14.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="amt-carrier.html"><a href="amt-carrier.html"><i class="fa fa-check"></i><b>15</b> A critical evaluation of ammonium transporter kinetics</a><ul>
<li class="chapter" data-level="15.1" data-path="amt-carrier.html"><a href="amt-carrier.html#exercises-12"><i class="fa fa-check"></i><b>15.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html"><i class="fa fa-check"></i><b>16</b> Bias in metabolomics data</a><ul>
<li class="chapter" data-level="16.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#exercises-13"><i class="fa fa-check"></i><b>16.1</b> Exercises</a><ul>
<li class="chapter" data-level="16.1.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#an-alternative-solution-generalized-additive-modeling-optional"><i class="fa fa-check"></i><b>16.1.1</b> An alternative solution: Generalized additive modeling (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="nerve-fiber.html"><a href="nerve-fiber.html"><i class="fa fa-check"></i><b>17</b> Correlation between fiber density and episodic memory?</a><ul>
<li class="chapter" data-level="17.1" data-path="nerve-fiber.html"><a href="nerve-fiber.html#exercises-14"><i class="fa fa-check"></i><b>17.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="classifiers.html"><a href="classifiers.html"><i class="fa fa-check"></i><b>18</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.1" data-path="classifiers.html"><a href="classifiers.html#classifiers"><i class="fa fa-check"></i><b>18.1</b> Classifiers</a></li>
<li class="chapter" data-level="18.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression"><i class="fa fa-check"></i><b>18.2</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.2.1" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-a-case-of-generalized-linear-modeling"><i class="fa fa-check"></i><b>18.2.1</b> Logistic Regression: a case of Generalized Linear Modeling</a></li>
<li class="chapter" data-level="18.2.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-in-r"><i class="fa fa-check"></i><b>18.2.2</b> Logistic regression in R</a></li>
<li class="chapter" data-level="18.2.3" data-path="classifiers.html"><a href="classifiers.html#exercises-15"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html"><i class="fa fa-check"></i><b>19</b> Classification of dairy bacteria</a><ul>
<li class="chapter" data-level="19.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#exercises-16"><i class="fa fa-check"></i><b>19.1</b> Exercises</a><ul>
<li class="chapter" data-level="19.1.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#description-of-the-data"><i class="fa fa-check"></i><b>19.1.1</b> Description of the data</a></li>
<li class="chapter" data-level="19.1.2" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-conversion"><i class="fa fa-check"></i><b>19.1.2</b> Data conversion</a></li>
<li class="chapter" data-level="19.1.3" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-analysis"><i class="fa fa-check"></i><b>19.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="naivebayes.html"><a href="naivebayes.html"><i class="fa fa-check"></i><b>20</b> Naïve Bayes classifiers</a><ul>
<li class="chapter" data-level="20.1" data-path="naivebayes.html"><a href="naivebayes.html#the-naive-bayes-classifier"><i class="fa fa-check"></i><b>20.1</b> The Naive Bayes classifier</a></li>
<li class="chapter" data-level="20.2" data-path="naivebayes.html"><a href="naivebayes.html#a-crime-scene"><i class="fa fa-check"></i><b>20.2</b> A crime scene</a></li>
<li class="chapter" data-level="20.3" data-path="naivebayes.html"><a href="naivebayes.html#reconstructing-bayes-lawtheorem"><i class="fa fa-check"></i><b>20.3</b> Reconstructing Bayes law/theorem</a></li>
<li class="chapter" data-level="20.4" data-path="naivebayes.html"><a href="naivebayes.html#deciding-on-the-class"><i class="fa fa-check"></i><b>20.4</b> Deciding on the class</a></li>
<li class="chapter" data-level="20.5" data-path="naivebayes.html"><a href="naivebayes.html#continuous-predicting-variables"><i class="fa fa-check"></i><b>20.5</b> Continuous predicting variables</a></li>
<li class="chapter" data-level="20.6" data-path="naivebayes.html"><a href="naivebayes.html#combining-information-from-different-predictor-variables"><i class="fa fa-check"></i><b>20.6</b> Combining information from different predictor variables</a></li>
<li class="chapter" data-level="20.7" data-path="naivebayes.html"><a href="naivebayes.html#exercises-17"><i class="fa fa-check"></i><b>20.7</b> Exercises</a><ul>
<li class="chapter" data-level="20.7.1" data-path="naivebayes.html"><a href="naivebayes.html#predicting-iris-species"><i class="fa fa-check"></i><b>20.7.1</b> Predicting iris species</a></li>
<li class="chapter" data-level="20.7.2" data-path="naivebayes.html"><a href="naivebayes.html#predicting-income"><i class="fa fa-check"></i><b>20.7.2</b> Predicting income</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="resampling-techniques.html"><a href="resampling-techniques.html"><i class="fa fa-check"></i><b>21</b> Resampling techniques</a><ul>
<li class="chapter" data-level="21.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#bootstrapping"><i class="fa fa-check"></i><b>21.1</b> Bootstrapping</a></li>
<li class="chapter" data-level="21.2" data-path="resampling-techniques.html"><a href="resampling-techniques.html#exercises-18"><i class="fa fa-check"></i><b>21.2</b> Exercises</a><ul>
<li class="chapter" data-level="21.2.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#medical-patches"><i class="fa fa-check"></i><b>21.2.1</b> Medical patches</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="resampling-techniques.html"><a href="resampling-techniques.html#permutation-test"><i class="fa fa-check"></i><b>21.3</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html"><i class="fa fa-check"></i><b>22</b> Numerical differentiation and smoothing</a><ul>
<li class="chapter" data-level="22.1" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#exercises-19"><i class="fa fa-check"></i><b>22.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="randomnumbers.html"><a href="randomnumbers.html"><i class="fa fa-check"></i><b>23</b> Random numbers</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vectorization" class="section level1">
<h1><span class="header-section-number">CHAPTER 8</span> Vectorization</h1>
<p>In section <a href="Programming-with-R.html#program-flow-control">7.2</a> we mentioned that R has very efficient alternatives for repetitive tasks that in other programming environments often require looping constructs. This is called <em>vectorization</em>, and it is an important technique in R. We have already seen cases of vectorization. Suppose we have a vector <code>a &lt;- c(5,3,7)</code>. The following expression adds 1 to every element of <code>a</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">+</span><span class="dv">1</span></code></pre></div>
<pre><code>## [1] 6 4 8</code></pre>
<p>Implicitly, it loops over every element of the longest vector <code>a</code> and adds to it the element of the shortest vector <code>c(1)</code>, equivalent to the following implementation with looping:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&#39;numeric&#39;</span>,<span class="dt">length=</span><span class="kw">length</span>(a))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a)) {
  result[i] &lt;-<span class="st"> </span>a[i] <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
}
result</code></pre></div>
<pre><code>## [1] 6 4 8</code></pre>
<p>Another example is the replacement of elements of a vector using a logical vector. Suppose we want to replace all elements of <code>y &lt;- c(0,4,3,6,0,2)</code> that are equal to 0 by 1. This can be done as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">2</span>)
y[y<span class="op">==</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
y</code></pre></div>
<pre><code>## [1] 1 4 3 6 1 2</code></pre>
<p>Implicitly, this simple statement first loops over every element of <code>y</code> and creates a logical vector (say <code>test</code>), having the same length as <code>y</code>, in which the elements are <code>TRUE</code> when the corresponding element in <code>y</code> equals 0, and <code>FALSE</code> otherwise. Subsequently, it replaces the corresponding element in <code>y</code> if the element in <code>test</code> equals <code>TRUE</code>. In code it is equivalent to:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&#39;logical&#39;</span>, <span class="dt">length=</span><span class="kw">length</span>(y))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(y)) {
  <span class="cf">if</span> (y[i]<span class="op">==</span><span class="dv">0</span>) {
    test[i] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
  } <span class="cf">else</span> {
    test[i] &lt;-<span class="st"> </span><span class="ot">FALSE</span>
  }
}
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(y)) {
  <span class="cf">if</span> (test[i]<span class="op">==</span><span class="ot">TRUE</span>) {
    y[i] &lt;-<span class="st"> </span><span class="dv">1</span>
  }
}
y</code></pre></div>
<pre><code>## [1] 1 4 3 6 1 2</code></pre>
<p>You will probably agree that the vectorized forms are, from a coding perspective, much more efficient, and therefore less prone to error! As a bonus, vectorized code often executes faster, especially when dealing with large data structures. So, vectorization is an important property of R, and you should use it as much as possible<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a></p>
<p>Below we will discuss a few functions that help you with the vectorization of slightly more complex tasks in R. They are the functions <code>apply()</code>, <code>tapply()</code>, <code>sapply()</code> and <code>lapply()</code>. Basically, these functions loop over a data structure, like a matrix, a data frame or a list, and apply a function to a sub-structure, like a row or column (which then turn into vectors), or a list element.</p>
<div id="the-function-apply" class="section level2">
<h2><span class="header-section-number">8.1</span> The function <code>apply()</code></h2>
<p>Take a look at the help file for the function <code>apply(X, MARGIN, FUN, ...)</code>. It tells you that as its first argument <code>X</code>, <code>apply()</code> takes an array, and if the input is not an array, but it does have a dimension property (like matrix and data.frame have), it will try to coerce it to an array. Its third argument <code>FUN</code> is the name of a function to be applied to <code>X</code>, and the second argument <code>MARGIN</code> indicates over which dimension the function is to be applied, where, for a 2-dimensional array 1 represents rows and 2 represents columns.</p>
<p>Suppose you have the following data frame containing scores of 5 pupils on two different exams:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">exam1=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">5</span>), <span class="dt">exam2=</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">4</span>), <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&#39;pupil1&#39;</span>,<span class="st">&#39;pupil2&#39;</span>,<span class="st">&#39;pupil3&#39;</span>,<span class="st">&#39;pupil4&#39;</span>,<span class="st">&#39;pupil5&#39;</span>))
d</code></pre></div>
<pre><code>##        exam1 exam2
## pupil1     7     6
## pupil2     6     7
## pupil3     8     7
## pupil4     9     7
## pupil5     5     4</code></pre>
<p>You want to know the mean scores of each of the pupils (rows) and on each of the exams (columns). Instead of programming a loop over the rows or columns, we can simply state:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">1</span>,mean)</code></pre></div>
<pre><code>## pupil1 pupil2 pupil3 pupil4 pupil5 
##    6.5    6.5    7.5    8.0    4.5</code></pre>
<p>or</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">2</span>,mean)</code></pre></div>
<pre><code>## exam1 exam2 
##   7.0   6.2</code></pre>
<p>(What type of object is the output of <code>apply()</code> here?). Do you understand the connection between the value of the second <code>MARGIN</code> argument (1 or 2) and the outcome? You are not limited to applying pre-defined functions over arrays. You can also define your own function and put its name in the FUN argument. Suppose we want to know for each pupil whether it has passed all exams, using the rule that the average over the exams has to be 5.5 or larger. We can define a function named “passfunction” that returns “pass” or “fail” for a vector of exam scores of a pupil:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">passfunction &lt;-<span class="st"> </span><span class="cf">function</span>(scores) {
  <span class="cf">if</span>(<span class="kw">mean</span>(scores)<span class="op">&gt;=</span><span class="fl">5.5</span>) {
    <span class="kw">return</span>(<span class="st">&#39;pass&#39;</span>)
  } <span class="cf">else</span> {
    <span class="kw">return</span>(<span class="st">&#39;fail&#39;</span>)
  }
}</code></pre></div>
<p>Now we can apply our function “passfunction” to the rows of <code>d</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">1</span>,passfunction)</code></pre></div>
<pre><code>## pupil1 pupil2 pupil3 pupil4 pupil5 
## &quot;pass&quot; &quot;pass&quot; &quot;pass&quot; &quot;pass&quot; &quot;fail&quot;</code></pre>
<p>Suppose we want to make our “passfunction” function a little more sophisticated by being able to enter the pass limit. We also want this limit to have a default value of 5.5, in case the user of our function does not enter a pass limit as an argument. We can re-define the function as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">passfunction &lt;-<span class="st"> </span><span class="cf">function</span>(scores, <span class="dt">limit=</span><span class="fl">5.5</span>) {
  <span class="cf">if</span>(<span class="kw">mean</span>(scores)<span class="op">&gt;=</span>limit) {
    <span class="kw">return</span>(<span class="st">&#39;pass&#39;</span>)
  } <span class="cf">else</span> {
    <span class="kw">return</span>(<span class="st">&#39;fail&#39;</span>)
  }
}</code></pre></div>
<p>We can apply this function as before to the rows of <code>d</code>, and it will show which pupils had an average score above or below 5.5. But suppose we want the pass limit to be 7.0, then we can add that limit as a fourth argument to <code>apply()</code>. This is what the <code>...</code> indicates in the definition of <code>apply(X, MARGIN, FUN, ...)</code>. For <code>...</code> you can enter any number of (named, or name inferred from position) arguments to the function <code>FUN</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">1</span>,passfunction,<span class="dt">limit=</span><span class="fl">7.0</span>)</code></pre></div>
<pre><code>## pupil1 pupil2 pupil3 pupil4 pupil5 
## &quot;fail&quot; &quot;fail&quot; &quot;pass&quot; &quot;pass&quot; &quot;fail&quot;</code></pre>
<p>To continue on this passing of arguments to the function applied by <code>apply()</code>, suppose we have a slight change of our exam data, where the first pupil did not show up at the first exam:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d[<span class="st">&#39;pupil1&#39;</span>,<span class="st">&#39;exam1&#39;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre></div>
<p>Now, <code>apply(d,1,mean)</code> and <code>apply(d,2,mean)</code> will yield <code>NA</code> for the first row and column, which may be undesirable (try it). But of course, we could let the <code>apply()</code> function pass on the argument <code>na.rm=TRUE</code> to the <code>mean()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">1</span>,mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## pupil1 pupil2 pupil3 pupil4 pupil5 
##    6.0    6.5    7.5    8.0    4.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(d,<span class="dv">2</span>,mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## exam1 exam2 
##   7.0   6.2</code></pre>
<p>and obtain averages again for the first row and column.</p>
</div>
<div id="the-function-tapply" class="section level2">
<h2><span class="header-section-number">8.2</span> The function <code id="the-function-tapply">tapply()</code></h2>
<p>Suppose we have the following data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">exam1=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">5</span>), <span class="dt">exam2=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>), <span class="dt">gender=</span><span class="kw">c</span>(<span class="st">&#39;female&#39;</span>,<span class="st">&#39;female&#39;</span>,<span class="st">&#39;male&#39;</span>,<span class="st">&#39;male&#39;</span>,<span class="st">&#39;female&#39;</span>), <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&#39;pupil1&#39;</span>,<span class="st">&#39;pupil2&#39;</span>,<span class="st">&#39;pupil3&#39;</span>,<span class="st">&#39;pupil4&#39;</span>,<span class="st">&#39;pupil5&#39;</span>))
d</code></pre></div>
<pre><code>##        exam1 exam2 gender
## pupil1     7     4 female
## pupil2     6     5 female
## pupil3     8     5   male
## pupil4     9     7   male
## pupil5     5     3 female</code></pre>
<p>We want to know the average score for exam1 by gender, so separately for male and female. Also in this case, we could program a loop structure, testing gender, adding the score to either male or female sum, and finally taking the averages. But there is a much simpler solution that uses vectorization. It uses the function <code>tapply()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>exam1, d<span class="op">$</span>gender, mean)</code></pre></div>
<pre><code>## female   male 
##    6.0    8.5</code></pre>
<p>What did we do here? Take a look at the definition of <code>tapply()</code> in its help page: <code>tapply(X, INDEX, FUN = NULL, ...)</code>. as input <code>X</code> we need an atomic object, typically a vector (here <code>d$exam1</code>). The third argument <code>FUN</code> was again the name of the function that we want to use (<code>mean</code>), and the second argument <code>INDEX</code> should be one or more factors (if more than one, they are provided as a list) of the same length as <code>X</code> that we want to use to separate the data in <code>X</code>. In our case we used one factor: <code>d$gender</code>.</p>
</div>
<div id="the-functions-lapply-and-sapply" class="section level2">
<h2><span class="header-section-number">8.3</span> The functions <code>lapply()</code> and <code>sapply()</code></h2>
<p>The function <code>lapply()</code> (list-apply) applies a selected function to each element of a list. The answer is returned as a list of the same length (the same number of elements) as the list to which it was applied. Suppose you have a list of numeric vectors of different length:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mylist &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">v1=</span><span class="kw">runif</span>(<span class="dv">12</span>),<span class="dt">v2=</span><span class="kw">runif</span>(<span class="dv">100</span>),<span class="dt">v3=</span><span class="kw">runif</span>(<span class="dv">23</span>))</code></pre></div>
<p>and you would like to know the mean of each of these lists. Then, instead of making a for-loop construct looping over each element, you can just type</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(mylist,mean)</code></pre></div>
<pre><code>## $v1
## [1] 0.4914725
## 
## $v2
## [1] 0.5284289
## 
## $v3
## [1] 0.4352408</code></pre>
<p>This gives a list of the three means. The function <code>sapply()</code> does the same as <code>lapply()</code>, but if possible, returns a vector or matrix as a result. This is only possible if the function that was applied is guaranteed to return a fixed number of results for each element to which it was applied. The function <code>mean()</code> always returns a single number, or <code>NA</code>, so <code>sapply()</code> should work here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(mylist, mean)</code></pre></div>
<pre><code>##        v1        v2        v3 
## 0.4914725 0.5284289 0.4352408</code></pre>
<p>Verify, using the <code>class()</code> function that the classes of the results from both functions are indeed as was stated above.</p>
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">8.4</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Instead of using a <code>for</code> loop, use the <code>apply()</code> function to calculate the column averages of the matrix <code>a</code> section <a href="Programming-with-R.html#programming-loops">7.4.1</a>
<div>
<a id="VectorizationHead1" href="javascript:toggle('VectorizationSol1','VectorizationHead1');" >Show solution</a>
</div>
<div id="VectorizationSol1" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)
<span class="kw">apply</span>(a, <span class="dv">2</span>, mean)</code></pre></div>
<pre><code>##  [1]  5.5 15.5 25.5 35.5 45.5 55.5 65.5 75.5 85.5 95.5</code></pre>
</div></li>
<li>Use <code>apply()</code> to calculate a) the mean scores per pupil and b) per exam on the data frame in section <a href="vectorization.html#the-function-tapply">8.2</a>. Tip: use a sub-selection of the columns of <code>d</code>, selected with a bracket operator, to apply the function <code>mean()</code> to.
<div>
<a id="VectorizationHead2" href="javascript:toggle('VectorizationSol2','VectorizationHead2');" >Show solution</a>
</div>
<div id="VectorizationSol2" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">exam1=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">5</span>), <span class="dt">exam2=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>), <span class="dt">gender=</span><span class="kw">c</span>(<span class="st">&#39;female&#39;</span>,<span class="st">&#39;female&#39;</span>,<span class="st">&#39;male&#39;</span>,<span class="st">&#39;male&#39;</span>,<span class="st">&#39;female&#39;</span>), <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&#39;pupil1&#39;</span>,<span class="st">&#39;pupil2&#39;</span>,<span class="st">&#39;pupil3&#39;</span>,<span class="st">&#39;pupil4&#39;</span>,<span class="st">&#39;pupil5&#39;</span>))
<span class="kw">apply</span>(d[<span class="kw">c</span>(<span class="st">&#39;exam1&#39;</span>,<span class="st">&#39;exam2&#39;</span>)], <span class="dv">1</span>, mean)</code></pre></div>
<pre><code>## pupil1 pupil2 pupil3 pupil4 pupil5 
##    5.5    5.5    6.5    8.0    4.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this column selection works because a data frame is a child class of list (columns are list elements). Alternatively treat a data frame as a matrix: apply(d[,c(&#39;exam1&#39;,&#39;exam2&#39;)], 1, mean)</span>
<span class="kw">apply</span>(d[<span class="kw">c</span>(<span class="st">&#39;exam1&#39;</span>,<span class="st">&#39;exam2&#39;</span>)], <span class="dv">2</span>, mean)</code></pre></div>
<pre><code>## exam1 exam2 
##   7.0   4.8</code></pre>
</div></li>
<li><p>Add a second factor <code>hair</code> to the data frame in section <a href="vectorization.html#the-function-tapply">8.2</a> and calculate the mean score on exam1 by hair color. Also calculate the mean score by gender and hair color. Tip: in the last case use as an index the list composed of <code>d$gender</code> and <code>d$hair</code>. This exercise will probably confirm all your prejudices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>hair &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;brunette&#39;</span>,<span class="st">&#39;blonde&#39;</span>,<span class="st">&#39;blonde&#39;</span>,<span class="st">&#39;brunette&#39;</span>,<span class="st">&#39;blonde&#39;</span>))</code></pre></div>
<div>
<a id="VectorizationHead3" href="javascript:toggle('VectorizationSol3','VectorizationHead3');" >Show solution</a>
</div>
<div id="VectorizationSol3" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>exam1, d<span class="op">$</span>hair, mean)</code></pre></div>
<pre><code>##   blonde brunette 
## 6.333333 8.000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(d<span class="op">$</span>exam1, <span class="kw">list</span>(d<span class="op">$</span>gender,d<span class="op">$</span>hair), mean)</code></pre></div>
<pre><code>##        blonde brunette
## female    5.5        7
## male      8.0        9</code></pre>
</div></li>
<li>Preparing for the next exercise: if you calculate the mean of a numeric vector containing an <code>NA</code> element, then the result will be <code>NA</code>, unless you provide the argument <code>na.rm=TRUE</code> to the <code>mean()</code> function. Calculate the mean of <code>a &lt;- c(0:10, NA, 11:20)</code>, disregarding the NA element (it should equal 10).
<div>
<a id="VectorizationHead4" href="javascript:toggle('VectorizationSol4','VectorizationHead4');" >Show solution</a>
</div>
<div id="VectorizationSol4" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, <span class="ot">NA</span>, <span class="dv">11</span><span class="op">:</span><span class="dv">20</span>)
<span class="kw">mean</span>(a, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 10</code></pre>
</div></li>
<li><p>Create the data frame <code>u</code> and, using the <code>apply()</code> function, calculate the row- and column means, disregarding the NA elements. Look up in the help page of the <code>apply()</code> function how to pass the <code>na.rm=TRUE</code> argument to the <code>mean()</code> function in an <code>apply()</code> statement. Also calculate the standard deviations of the columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">var1=</span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">var2=</span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">1</span>))
u<span class="op">$</span>var1[<span class="kw">runif</span>(<span class="kw">length</span>(u<span class="op">$</span>var1))<span class="op">&gt;</span><span class="fl">0.90</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
u<span class="op">$</span>var2[<span class="kw">runif</span>(<span class="kw">length</span>(u<span class="op">$</span>var2))<span class="op">&gt;</span><span class="fl">0.90</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre></div>
<div>
<a id="VectorizationHead5" href="javascript:toggle('VectorizationSol5','VectorizationHead5');" >Show solution</a>
</div>
<div id="VectorizationSol5" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(u,<span class="dv">1</span>,mean,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">apply</span>(u,<span class="dv">2</span>,mean,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">apply</span>(u,<span class="dv">2</span>,sd,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div></li>
<li><p>By the way, do you understand how <code>u</code> is constructed? Look up the help page for the <code>rnorm()</code> function for generation of random numbers from a normal distribution.</p></li>
<li>Again using the data frame <code>d</code> with the exam scores: use <code>apply()</code> and <code>tapply()</code> to calculate with a one line statement the average scores over both exams for males and females of the data used in section <a href="vectorization.html#the-function-tapply">8.2</a>. Tip: perform a <code>tapply()</code> on an <code>apply()</code> on (a subset of) columns of the data frame. Use the appropriate additional arguments.
<div>
<a id="VectorizationHead6" href="javascript:toggle('VectorizationSol6','VectorizationHead6');" >Show solution</a>
</div>
<div id="VectorizationSol6" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(<span class="kw">apply</span>(d[<span class="kw">c</span>(<span class="st">&#39;exam1&#39;</span>,<span class="st">&#39;exam2&#39;</span>)], <span class="dv">1</span>, mean), d<span class="op">$</span>gender, mean)</code></pre></div>
<pre><code>## female   male 
##   5.00   7.25</code></pre>
</div></li>
<li><p>Create the list of lists</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flintstones &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">person1=</span><span class="kw">list</span>(<span class="dt">name=</span><span class="st">&#39;Fred&#39;</span>, <span class="dt">kids=</span><span class="kw">c</span>(<span class="st">&#39;Pebbles&#39;</span>), <span class="dt">married=</span><span class="ot">TRUE</span>, <span class="dt">pets=</span><span class="kw">c</span>(<span class="st">&#39;Dino&#39;</span>,<span class="st">&#39;Baby Puss&#39;</span>,<span class="st">&#39;Doozy&#39;</span>)), <span class="dt">person2=</span><span class="kw">list</span>(<span class="dt">name=</span><span class="st">&#39;Barney&#39;</span>, <span class="dt">kids=</span><span class="st">&#39;Bamm-Bamm&#39;</span>, <span class="dt">married=</span><span class="ot">TRUE</span>, <span class="dt">pets=</span><span class="st">&#39;Hoppy&#39;</span>))</code></pre></div>
Using the function <code>lapply()</code> or <code>sapply()</code>, extract the names of the persons from this list. Tip: as you saw before, the bracket operators are just functions having the names “[” and “[[”. The function to apply to each element is a bracket operator. Don’t forget to quote it, otherwise the usual syntax of the bracket operator is expected.
<div>
<a id="VectorizationHead7" href="javascript:toggle('VectorizationSol7','VectorizationHead7');" >Show solution</a>
</div>
<div id="VectorizationSol7" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(flintstones, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;name&#39;</span>)</code></pre></div>
<pre><code>## $person1
## [1] &quot;Fred&quot;
## 
## $person2
## [1] &quot;Barney&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># or yielding a more compact result, if possible</span>
<span class="kw">sapply</span>(flintstones, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;name&#39;</span>)</code></pre></div>
<pre><code>##  person1  person2 
##   &quot;Fred&quot; &quot;Barney&quot;</code></pre>
</div></li>
<li><p>The exercise above returns a list in case of one bracket operator and a vector in case of the other when you use <code>sapply()</code>. Do you understand why? In case that it returns a list, you can use the <code>unlist()</code> function to turn the result into a character vector. Try that!</p></li>
<li>In a one-line statement, calculate the mean number of pets in the <code>flintstones</code> list for all persons. To construct this statement work it out in stages. First extract the “pets” elements in a new list, as you did above for the names. Then apply the <code>length()</code> function to each of its elements, obtaining a vector (use <code>sapply()</code>) with numbers of pets. Finally, use the <code>mean()</code> function to calculate the mean number of pets. Of course, in case of a small list this effort is a bit overdone, but for large lists this is the most efficient way.
<div>
<a id="VectorizationHead8" href="javascript:toggle('VectorizationSol8','VectorizationHead8');" >Show solution</a>
</div>
<div id="VectorizationSol8" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">sapply</span>(<span class="kw">lapply</span>(flintstones, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;pets&#39;</span>), length))</code></pre></div>
<pre><code>## [1] 2</code></pre>
</div></li>
<li>Instead of looping over a vector of integers with a <code>for</code> loop (for example, <code>for (i in 1:10) {...}</code>) you can use and <code>lapply()</code> or <code>sapply()</code> on that vector. It is used often in later chapters in this syllabus, and especially useful if you need results in a list. Use this cosntruct to do a “leave one out” analysis. In this case (admittedly, not a very useful one), to calculate the 10 different means and standard deviations of 9 out of 10 entries in the vector <code>runif(10)</code> by leaving each entry out once. The output should be a 10 <span class="math inline">\(\times\)</span> 2 matrix with “mean” and “sd” columns.
<div>
<a id="VectorizationHead9" href="javascript:toggle('VectorizationSol9','VectorizationHead9');" >Show solution</a>
</div>
<div id="VectorizationSol9" style="display: none">

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)
<span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i){<span class="kw">c</span>(<span class="kw">mean</span>(d[<span class="op">-</span>i]), <span class="kw">sd</span>(d[<span class="op">-</span>i]))}))</code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.3577275 0.2572868
##  [2,] 0.3593072 0.2568172
##  [3,] 0.2985961 0.1866755
##  [4,] 0.3812052 0.2383784
##  [5,] 0.3860650 0.2309436
##  [6,] 0.3520557 0.2580711
##  [7,] 0.3305451 0.2481043
##  [8,] 0.3230868 0.2395325
##  [9,] 0.3606522 0.2563303
## [10,] 0.3680012 0.2522327</code></pre></li>
<li><p>Adapt the function <code>Rho_W(T)</code> in section <a href="Programming-with-R.html#program-flow-control">7.2</a> so that it also accepts an argument <code>T</code> with length &gt;1.</p></li>
</ol>
<div id="permutation-function" class="section level3">
<h3><span class="header-section-number">8.4.1</span> A permutation function</h3>
<ol style="list-style-type: decimal">
<li><p>(DIFFICULT) Make a function “permute” that takes two arguments: 1) an alphabet consisting of a set of symbols and 2) a length being a single integer N. An alphabet could, for example, be the set of DNA nucleotides {“A”, “T”, “G”, “C”}. The function has as an output a character matrix containing all possible combinations of length N of the elements of the alphabet, the first column in the matrix containing the first element, the second column containing the second element, <em>etc</em>. The names of the rows of the output matrix should correspond to the complete string. For example, the output generating all combinations of {“a”, “b”, “c”} of length 2 would look like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alphabet &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>)
a &lt;-<span class="st"> </span><span class="kw">permute</span>(alphabet, <span class="dv">2</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a</code></pre></div>
<pre><code>##    [,1] [,2]
## aa &quot;a&quot;  &quot;a&quot; 
## ab &quot;a&quot;  &quot;b&quot; 
## ac &quot;a&quot;  &quot;c&quot; 
## ba &quot;b&quot;  &quot;a&quot; 
## bb &quot;b&quot;  &quot;b&quot; 
## bc &quot;b&quot;  &quot;c&quot; 
## ca &quot;c&quot;  &quot;a&quot; 
## cb &quot;c&quot;  &quot;b&quot; 
## cc &quot;c&quot;  &quot;c&quot;</code></pre>
The function can be written in less than 15 lines.
<div>
<a id="VectorizationHead10" href="javascript:toggle('VectorizationSol10','VectorizationHead10');" >Show solution</a>
</div>
<div id="VectorizationSol10" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Function for the generation of all permutations of
## length n of a vector v
permute &lt;-<span class="st"> </span><span class="cf">function</span>(v, n) {
  vl &lt;-<span class="st"> </span><span class="kw">length</span> (v)
  <span class="cf">if</span> (n <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) { <span class="co"># </span><span class="al">TODO</span><span class="co">: build in safety for large n</span>
    i &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
    r &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(v, <span class="dt">each=</span>vl<span class="op">^</span>i), <span class="dt">ncol=</span><span class="dv">1</span>)
    <span class="cf">while</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
      i &lt;-<span class="st"> </span>i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
      r &lt;-<span class="st"> </span><span class="kw">cbind</span>(r,<span class="kw">rep</span>(<span class="kw">rep</span>(v, <span class="dt">each=</span>vl<span class="op">^</span>i), <span class="dt">times=</span>(vl<span class="op">^</span>(n<span class="op">-</span>i<span class="op">-</span><span class="dv">1</span>))))
    }
    <span class="kw">rownames</span>(r) &lt;-<span class="st"> </span><span class="kw">apply</span>(r, <span class="dv">1</span>, paste, <span class="dt">collapse=</span><span class="st">&#39;&#39;</span>)
    <span class="kw">return</span>(r)
  }
}

## Another solution uses the standard function expand.grid(), which
## generates a data frame from all combinations of a set of factor
## variables. To generate the list of factor variables to be used
## as arguments to expand.grid(), we use lapply(). Functions like
## expand.grid() or cbind(), taking indefinite length arguments can
## be called with a list of arguments using the function do.call()

permute2 &lt;-<span class="st"> </span><span class="cf">function</span>(v, n) {
  <span class="cf">if</span> (n <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) { <span class="co"># </span><span class="al">TODO</span><span class="co">: build in safety for large n</span>
    arglist &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(x){<span class="kw">return</span> (v)})
    r &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">do.call</span>(expand.grid, arglist)) <span class="co"># rev reverses the order of the columns</span>
    <span class="kw">rownames</span>(r) &lt;-<span class="st"> </span><span class="kw">apply</span>(r, <span class="dv">1</span>, paste, <span class="dt">collapse=</span><span class="st">&#39;&#39;</span>)
    <span class="kw">return</span>(r)
  }
}</code></pre></div>
</div></li>
</ol>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Other languages that use this property, and that you may use at some point in your career are MATLAB and Mathematica.<a href="vectorization.html#fnref4">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Programming-with-R.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reshaping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "libs/mathjax-local/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
