<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Statistics with R</title>
  <meta name="description" content="Syllabus for the course ‘Statistics with R’">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Syllabus for the course ‘Statistics with R’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistics with R" />
  
  <meta name="twitter:description" content="Syllabus for the course ‘Statistics with R’" />
  

<meta name="author" content="Douwe Molenaar">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="interacting-with-r.html">
<link rel="next" href="file-io.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script language="javascript">
  function toggle(showHideDiv, switchTextDiv) {
  	var ele = document.getElementById(showHideDiv);
	  var text = document.getElementById(switchTextDiv);
	  if(ele.style.display == "block") {
	  	ele.style.display = "none";
	  	text.innerHTML = "Show solution";
	  }
	  else {
	  	ele.style.display = "block";
      text.innerHTML = "Hide solution";
	  }
  }
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="styles/style.css" type="text/css" />
<link rel="stylesheet" href="styles/block_elements.css" type="text/css" />
<link rel="stylesheet" href="styles/localadapt.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="1" data-path="studyguide.html"><a href="studyguide.html"><i class="fa fa-check"></i><b>1</b> Study guide</a><ul>
<li class="chapter" data-level="1.1" data-path="studyguide.html"><a href="studyguide.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="studyguide.html"><a href="studyguide.html#entry-conditions"><i class="fa fa-check"></i><b>1.2</b> Entry conditions</a></li>
<li class="chapter" data-level="1.3" data-path="studyguide.html"><a href="studyguide.html#goal-of-the-course"><i class="fa fa-check"></i><b>1.3</b> Goal of the course</a><ul>
<li class="chapter" data-level="1.3.1" data-path="studyguide.html"><a href="studyguide.html#this-is-not-a-statistics-course"><i class="fa fa-check"></i><b>1.3.1</b> This is not a statistics course</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="studyguide.html"><a href="studyguide.html#workload"><i class="fa fa-check"></i><b>1.4</b> Workload</a></li>
<li class="chapter" data-level="1.5" data-path="studyguide.html"><a href="studyguide.html#setup-and-content-of-the-course"><i class="fa fa-check"></i><b>1.5</b> Setup and content of the course</a><ul>
<li class="chapter" data-level="1.5.1" data-path="studyguide.html"><a href="studyguide.html#walk-in-hours"><i class="fa fa-check"></i><b>1.5.1</b> Walk-in hours</a></li>
<li class="chapter" data-level="1.5.2" data-path="studyguide.html"><a href="studyguide.html#syllabus"><i class="fa fa-check"></i><b>1.5.2</b> Syllabus</a></li>
<li class="chapter" data-level="1.5.3" data-path="studyguide.html"><a href="studyguide.html#assignments"><i class="fa fa-check"></i><b>1.5.3</b> Assignments</a></li>
<li class="chapter" data-level="1.5.4" data-path="studyguide.html"><a href="studyguide.html#assessment"><i class="fa fa-check"></i><b>1.5.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5.5" data-path="studyguide.html"><a href="studyguide.html#evaluation-of-the-course"><i class="fa fa-check"></i><b>1.5.5</b> Evaluation of the course</a></li>
<li class="chapter" data-level="1.5.6" data-path="studyguide.html"><a href="studyguide.html#course-schedule"><i class="fa fa-check"></i><b>1.5.6</b> Course schedule</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Technical background</b></span></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> A quick start</a><ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#resources-for-learning-r"><i class="fa fa-check"></i><b>2.2</b> Resources for learning R</a></li>
<li class="chapter" data-level="2.3" data-path="quick-start.html"><a href="quick-start.html#other-sources-on-the-use-of-r"><i class="fa fa-check"></i><b>2.3</b> Other sources on the use of R</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start.html"><a href="quick-start.html#installation-of-r"><i class="fa fa-check"></i><b>2.4</b> Installation of R</a></li>
<li class="chapter" data-level="2.5" data-path="quick-start.html"><a href="quick-start.html#starting-r"><i class="fa fa-check"></i><b>2.5</b> Starting R</a></li>
<li class="chapter" data-level="2.6" data-path="quick-start.html"><a href="quick-start.html#obtaining-help"><i class="fa fa-check"></i><b>2.6</b> Obtaining help</a></li>
<li class="chapter" data-level="2.7" data-path="quick-start.html"><a href="quick-start.html#an-r-session"><i class="fa fa-check"></i><b>2.7</b> An R-session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html"><i class="fa fa-check"></i><b>3</b> Elementary data types and operations</a><ul>
<li class="chapter" data-level="3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-atomic-data-types"><i class="fa fa-check"></i><b>3.1</b> The atomic data types</a></li>
<li class="chapter" data-level="3.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#the-basic-data-object-classes"><i class="fa fa-check"></i><b>3.2</b> The basic data object classes</a></li>
<li class="chapter" data-level="3.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#assigning-names-to-r-objects"><i class="fa fa-check"></i><b>3.3</b> Assigning names to R-objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#listing-objects-in-memory"><i class="fa fa-check"></i><b>3.3.1</b> Listing objects in memory</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#arithmetic-with-vectors-arrays-and-data-frames"><i class="fa fa-check"></i><b>3.4</b> Arithmetic with vectors, arrays, and data frames</a></li>
<li class="chapter" data-level="3.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-and-replacing-parts-of-data-objects"><i class="fa fa-check"></i><b>3.5</b> Extracting and replacing parts of data objects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#extracting-a-single-sub-object-with-the-double-bracket-index-selector"><i class="fa fa-check"></i><b>3.5.1</b> Extracting a single sub-object with the double bracket index selector <code>[[</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#for-data-frames-and-lists-and-selectors-behave-similarly"><i class="fa fa-check"></i><b>3.5.2</b> For data frames and lists <code>$</code> and <code>[[</code> selectors behave similarly</a></li>
<li class="chapter" data-level="3.5.3" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#complement-syntax"><i class="fa fa-check"></i><b>3.5.3</b> Selecting portions with the single bracket selector <code>[</code></a></li>
<li class="chapter" data-level="3.5.4" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#changing-parts-of-a-vector"><i class="fa fa-check"></i><b>3.5.4</b> Changing parts of a vector</a></li>
<li class="chapter" data-level="3.5.5" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-data-frames"><i class="fa fa-check"></i><b>3.5.5</b> Effect of the selector operators on data frames</a></li>
<li class="chapter" data-level="3.5.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#effect-of-the-selector-operators-on-arrays"><i class="fa fa-check"></i><b>3.5.6</b> Effect of the selector operators on arrays</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#removingelements"><i class="fa fa-check"></i><b>3.6</b> Removing elements from objects</a></li>
<li class="chapter" data-level="3.7" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#coercion"><i class="fa fa-check"></i><b>3.7</b> Data class conversion or coercion</a></li>
<li class="chapter" data-level="3.8" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#selection"><i class="fa fa-check"></i>Selection</a></li>
<li class="chapter" data-level="" data-path="elementary-datatypes.html"><a href="elementary-datatypes.html#more-selection-vectors-and-sequences"><i class="fa fa-check"></i>More selection, vectors and sequences</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interacting-with-r.html"><a href="interacting-with-r.html"><i class="fa fa-check"></i><b>4</b> Interacting with R</a><ul>
<li class="chapter" data-level="4.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#controlling-r-from-a-script"><i class="fa fa-check"></i><b>4.1</b> Controlling R from a script</a></li>
<li class="chapter" data-level="4.2" data-path="interacting-with-r.html"><a href="interacting-with-r.html#other-editors"><i class="fa fa-check"></i><b>4.2</b> Other editors</a></li>
<li class="chapter" data-level="4.3" data-path="interacting-with-r.html"><a href="interacting-with-r.html#working-with-packages"><i class="fa fa-check"></i><b>4.3</b> Working with packages</a></li>
<li class="chapter" data-level="4.4" data-path="interacting-with-r.html"><a href="interacting-with-r.html#where-your-packages-are-installed"><i class="fa fa-check"></i><b>4.4</b> Where your packages are installed</a></li>
<li class="chapter" data-level="4.5" data-path="interacting-with-r.html"><a href="interacting-with-r.html#reproducible-research"><i class="fa fa-check"></i><b>4.5</b> Reproducible research</a><ul>
<li class="chapter" data-level="4.5.1" data-path="interacting-with-r.html"><a href="interacting-with-r.html#staying-organized"><i class="fa fa-check"></i><b>4.5.1</b> Staying organized</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="interacting-with-r.html"><a href="interacting-with-r.html#easy-organizing"><i class="fa fa-check"></i><b>4.6</b> Easy organizing with RStudio</a><ul>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#rmarkdown-documents"><i class="fa fa-check"></i>Rmarkdown documents</a></li>
<li class="chapter" data-level="" data-path="interacting-with-r.html"><a href="interacting-with-r.html#externalizing-code"><i class="fa fa-check"></i>Externalizing code</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="interacting-with-r.html"><a href="interacting-with-r.html#displaying-information-about-your-r-session"><i class="fa fa-check"></i><b>4.7</b> Displaying information about your R session</a></li>
<li class="chapter" data-level="4.8" data-path="interacting-with-r.html"><a href="interacting-with-r.html#citing-r-and-r-packages-in-reports-and-papers"><i class="fa fa-check"></i><b>4.8</b> Citing R and R-packages in reports and papers</a></li>
<li class="chapter" data-level="4.9" data-path="interacting-with-r.html"><a href="interacting-with-r.html#exercise-diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i><b>4.9</b> Exercise: diversity of deep-sea nematodes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#the-basics-of-r-graphics"><i class="fa fa-check"></i><b>5.1</b> The basics of R graphics</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#x-y-plots"><i class="fa fa-check"></i><b>5.2</b> X-Y plots</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>5.3</b> Histograms</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>5.4</b> Boxplots</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#images-and-contour-plots"><i class="fa fa-check"></i><b>5.5</b> Images and contour plots</a></li>
<li class="chapter" data-level="5.6" data-path="graphics.html"><a href="graphics.html#plotting-a-mathematical-function"><i class="fa fa-check"></i><b>5.6</b> Plotting a mathematical function</a></li>
<li class="chapter" data-level="5.7" data-path="graphics.html"><a href="graphics.html#multiple-figures-in-one-graphical-device"><i class="fa fa-check"></i><b>5.7</b> Multiple figures in one graphical device</a></li>
<li class="chapter" data-level="5.8" data-path="graphics.html"><a href="graphics.html#saving-graphs"><i class="fa fa-check"></i><b>5.8</b> Saving graphs</a></li>
<li class="chapter" data-level="5.9" data-path="graphics.html"><a href="graphics.html#graphical-systems"><i class="fa fa-check"></i><b>5.9</b> Different graphical systems and packages</a></li>
<li class="chapter" data-level="5.10" data-path="graphics.html"><a href="graphics.html#exercises-1"><i class="fa fa-check"></i><b>5.10</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#simple-curves"><i class="fa fa-check"></i>Simple curves</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#human-population-growth"><i class="fa fa-check"></i>Human population growth</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#toxic-ammonia"><i class="fa fa-check"></i>Toxic ammonia</a></li>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#the-iris-data-set"><i class="fa fa-check"></i>The iris data set</a></li>
<li><a href="graphics.html#automatic-coercion-by-plot">Automatic coercion by <code>plot()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="file-io.html"><a href="file-io.html"><i class="fa fa-check"></i><b>6</b> File input and output</a><ul>
<li class="chapter" data-level="6.1" data-path="file-io.html"><a href="file-io.html#defining-the-path-to-a-file-or-directory"><i class="fa fa-check"></i><b>6.1</b> Defining the path to a file or directory</a></li>
<li class="chapter" data-level="6.2" data-path="file-io.html"><a href="file-io.html#the-working-directory"><i class="fa fa-check"></i><b>6.2</b> The “working directory”</a></li>
<li class="chapter" data-level="6.3" data-path="file-io.html"><a href="file-io.html#using-the-read.table-and-write.table-functions"><i class="fa fa-check"></i><b>6.3</b> Using the <code>read.table</code> and <code>write.table</code> functions</a></li>
<li class="chapter" data-level="6.4" data-path="file-io.html"><a href="file-io.html#reading-data-from-a-webserver"><i class="fa fa-check"></i><b>6.4</b> Reading data from a webserver</a></li>
<li class="chapter" data-level="6.5" data-path="file-io.html"><a href="file-io.html#reading-data-from-compressed-files-and-archives"><i class="fa fa-check"></i><b>6.5</b> Reading data from compressed files and archives</a></li>
<li class="chapter" data-level="6.6" data-path="file-io.html"><a href="file-io.html#inputoutput-with-excel-files-and-database-management-systems"><i class="fa fa-check"></i><b>6.6</b> Input/output with Excel files and database management systems</a></li>
<li class="chapter" data-level="6.7" data-path="file-io.html"><a href="file-io.html#exercises-2"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Programming-with-R.html"><a href="Programming-with-R.html"><i class="fa fa-check"></i><b>7</b> Programming with R</a><ul>
<li class="chapter" data-level="7.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#defining-a-function"><i class="fa fa-check"></i><b>7.1</b> Defining a function</a></li>
<li class="chapter" data-level="7.2" data-path="Programming-with-R.html"><a href="Programming-with-R.html#program-flow-control"><i class="fa fa-check"></i><b>7.2</b> Program flow control</a></li>
<li class="chapter" data-level="7.3" data-path="Programming-with-R.html"><a href="Programming-with-R.html#literature"><i class="fa fa-check"></i><b>7.3</b> Literature</a></li>
<li class="chapter" data-level="7.4" data-path="Programming-with-R.html"><a href="Programming-with-R.html#exercises-3"><i class="fa fa-check"></i><b>7.4</b> Exercises</a><ul>
<li class="chapter" data-level="7.4.1" data-path="Programming-with-R.html"><a href="Programming-with-R.html#programming-loops"><i class="fa fa-check"></i><b>7.4.1</b> Loops</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-of-deep-sea-nematodes"><i class="fa fa-check"></i>Diversity of deep-sea nematodes</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#diversity-indices-a-function-optional"><i class="fa fa-check"></i>Diversity indices – a function (optional)</a></li>
<li class="chapter" data-level="" data-path="Programming-with-R.html"><a href="Programming-with-R.html#rarefaction-diversity-optional"><i class="fa fa-check"></i>Rarefaction diversity (optional)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Programming-with-R.html"><a href="Programming-with-R.html#add-prog-ex"><i class="fa fa-check"></i><b>7.5</b> Additional programming exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>8</b> Vectorization</a><ul>
<li class="chapter" data-level="8.1" data-path="vectorization.html"><a href="vectorization.html#the-function-apply"><i class="fa fa-check"></i><b>8.1</b> The function <code>apply()</code></a></li>
<li class="chapter" data-level="8.2" data-path="vectorization.html"><a href="vectorization.html#the-function-tapply"><i class="fa fa-check"></i><b>8.2</b> The function <code id="the-function-tapply">tapply()</code></a></li>
<li class="chapter" data-level="8.3" data-path="vectorization.html"><a href="vectorization.html#the-functions-lapply-and-sapply"><i class="fa fa-check"></i><b>8.3</b> The functions <code>lapply()</code> and <code>sapply()</code></a></li>
<li class="chapter" data-level="8.4" data-path="vectorization.html"><a href="vectorization.html#exercises-4"><i class="fa fa-check"></i><b>8.4</b> Exercises</a><ul>
<li class="chapter" data-level="8.4.1" data-path="vectorization.html"><a href="vectorization.html#permutation-function"><i class="fa fa-check"></i><b>8.4.1</b> A permutation function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>9</b> Reshaping and manipulating complex data</a><ul>
<li class="chapter" data-level="9.1" data-path="reshaping.html"><a href="reshaping.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.1</b> The <code>tidyr</code> package</a></li>
<li class="chapter" data-level="9.2" data-path="reshaping.html"><a href="reshaping.html#the-dplyr-package"><i class="fa fa-check"></i><b>9.2</b> The <code>dplyr</code> package</a></li>
<li class="chapter" data-level="9.3" data-path="reshaping.html"><a href="reshaping.html#exercises-5"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="formulasyntax.html"><a href="formulasyntax.html"><i class="fa fa-check"></i><b>10</b> Using formula syntax</a><ul>
<li class="chapter" data-level="10.1" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-plotting"><i class="fa fa-check"></i><b>10.1</b> Using formula syntax in plotting</a></li>
<li class="chapter" data-level="10.2" data-path="formulasyntax.html"><a href="formulasyntax.html#using-formula-syntax-in-model-definition"><i class="fa fa-check"></i><b>10.2</b> Using formula syntax in model definition</a><ul>
<li class="chapter" data-level="10.2.1" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-a-continuous-explanatory-variable"><i class="fa fa-check"></i><b>10.2.1</b> Data with a continuous explanatory variable</a></li>
<li class="chapter" data-level="10.2.2" data-path="formulasyntax.html"><a href="formulasyntax.html#data-with-two-discrete-explanatory-variables-factors"><i class="fa fa-check"></i><b>10.2.2</b> Data with two discrete explanatory variables (factors)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Applications</b></span></li>
<li class="chapter" data-level="11" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>11</b> The carnival of distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="distributions.html"><a href="distributions.html#distribution-functions"><i class="fa fa-check"></i><b>11.1</b> Distribution functions</a></li>
<li class="chapter" data-level="11.2" data-path="distributions.html"><a href="distributions.html#distribution-functions-in-r"><i class="fa fa-check"></i><b>11.2</b> Distribution functions in R</a></li>
<li class="chapter" data-level="11.3" data-path="distributions.html"><a href="distributions.html#the-exponential-and-poisson-distributions"><i class="fa fa-check"></i><b>11.3</b> The exponential and Poisson distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="distributions.html"><a href="distributions.html#the-bernoulli-and-binomial-distributions"><i class="fa fa-check"></i><b>11.4</b> The Bernoulli and binomial distributions</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="distributions.html"><a href="distributions.html#the-normal-and-standard-normal-distribution"><i class="fa fa-check"></i><b>11.5</b> The normal and standard normal distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="distributions.html"><a href="distributions.html#students-t-distribution"><i class="fa fa-check"></i><b>11.6</b> Student’s t-distribution</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="distributions.html"><a href="distributions.html#the-chi-squared-distribution"><i class="fa fa-check"></i><b>11.7</b> The chi-squared distribution</a><ul>
<li class="chapter" data-level="11.7.1" data-path="distributions.html"><a href="distributions.html#application-in-pearsons-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>11.7.1</b> Application in Pearson’s chi-square goodness of fit test</a></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercise-2"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="distributions.html"><a href="distributions.html#the-f-distribution"><i class="fa fa-check"></i><b>11.8</b> The F-distribution</a><ul>
<li class="chapter" data-level="11.8.1" data-path="distributions.html"><a href="distributions.html#analysis-of-variance"><i class="fa fa-check"></i><b>11.8.1</b> Analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linearmodels.html"><a href="linearmodels.html"><i class="fa fa-check"></i><b>12</b> Linear models and ANOVA</a><ul>
<li class="chapter" data-level="12.1" data-path="linearmodels.html"><a href="linearmodels.html#modeling-with-factor-type-predictor-variables"><i class="fa fa-check"></i><b>12.1</b> Modeling with factor-type predictor variables</a><ul>
<li class="chapter" data-level="12.1.1" data-path="linearmodels.html"><a href="linearmodels.html#alternative-dummy-variable-coding-schemes"><i class="fa fa-check"></i><b>12.1.1</b> Alternative dummy variable coding schemes</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-8"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="linearmodels.html"><a href="linearmodels.html#two-way-anovafactorial-anova"><i class="fa fa-check"></i><b>12.2</b> Two-way ANOVA/factorial ANOVA</a><ul>
<li class="chapter" data-level="12.2.1" data-path="linearmodels.html"><a href="linearmodels.html#unbalanced-data"><i class="fa fa-check"></i><b>12.2.1</b> Unbalanced data</a></li>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercise-5"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linearmodels.html"><a href="linearmodels.html#combinations-of-numerical-and-discrete-predictors"><i class="fa fa-check"></i><b>12.3</b> Combinations of numerical and discrete predictors</a><ul>
<li class="chapter" data-level="" data-path="linearmodels.html"><a href="linearmodels.html#exercises-9"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linearmodels.html"><a href="linearmodels.html#the-connection-between-linear-models-and-anova"><i class="fa fa-check"></i><b>12.4</b> The connection between linear models and ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hubble.html"><a href="hubble.html"><i class="fa fa-check"></i><b>13</b> The age of the universe</a><ul>
<li class="chapter" data-level="13.1" data-path="hubble.html"><a href="hubble.html#exercises-10"><i class="fa fa-check"></i><b>13.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="datafabrication.html"><a href="datafabrication.html"><i class="fa fa-check"></i><b>14</b> A case of data fabrication</a><ul>
<li class="chapter" data-level="14.1" data-path="datafabrication.html"><a href="datafabrication.html#exercises-11"><i class="fa fa-check"></i><b>14.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="amt-carrier.html"><a href="amt-carrier.html"><i class="fa fa-check"></i><b>15</b> A critical evaluation of ammonium transporter kinetics</a><ul>
<li class="chapter" data-level="15.1" data-path="amt-carrier.html"><a href="amt-carrier.html#exercises-12"><i class="fa fa-check"></i><b>15.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html"><i class="fa fa-check"></i><b>16</b> Bias in metabolomics data</a><ul>
<li class="chapter" data-level="16.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#exercises-13"><i class="fa fa-check"></i><b>16.1</b> Exercises</a><ul>
<li class="chapter" data-level="16.1.1" data-path="bias-metabolomics.html"><a href="bias-metabolomics.html#an-alternative-solution-generalized-additive-modeling-optional"><i class="fa fa-check"></i><b>16.1.1</b> An alternative solution: Generalized additive modeling (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="nerve-fiber.html"><a href="nerve-fiber.html"><i class="fa fa-check"></i><b>17</b> Correlation between fiber density and episodic memory?</a><ul>
<li class="chapter" data-level="17.1" data-path="nerve-fiber.html"><a href="nerve-fiber.html#exercises-14"><i class="fa fa-check"></i><b>17.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="classifiers.html"><a href="classifiers.html"><i class="fa fa-check"></i><b>18</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.1" data-path="classifiers.html"><a href="classifiers.html#classifiers"><i class="fa fa-check"></i><b>18.1</b> Classifiers</a></li>
<li class="chapter" data-level="18.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression"><i class="fa fa-check"></i><b>18.2</b> Logistic regression</a><ul>
<li class="chapter" data-level="18.2.1" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-a-case-of-generalized-linear-modeling"><i class="fa fa-check"></i><b>18.2.1</b> Logistic Regression: a case of Generalized Linear Modeling</a></li>
<li class="chapter" data-level="18.2.2" data-path="classifiers.html"><a href="classifiers.html#logistic-regression-in-r"><i class="fa fa-check"></i><b>18.2.2</b> Logistic regression in R</a></li>
<li class="chapter" data-level="18.2.3" data-path="classifiers.html"><a href="classifiers.html#exercises-15"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html"><i class="fa fa-check"></i><b>19</b> Classification of dairy bacteria</a><ul>
<li class="chapter" data-level="19.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#exercises-16"><i class="fa fa-check"></i><b>19.1</b> Exercises</a><ul>
<li class="chapter" data-level="19.1.1" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#description-of-the-data"><i class="fa fa-check"></i><b>19.1.1</b> Description of the data</a></li>
<li class="chapter" data-level="19.1.2" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-conversion"><i class="fa fa-check"></i><b>19.1.2</b> Data conversion</a></li>
<li class="chapter" data-level="19.1.3" data-path="class-dairy-strains.html"><a href="class-dairy-strains.html#data-analysis"><i class="fa fa-check"></i><b>19.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="naivebayes.html"><a href="naivebayes.html"><i class="fa fa-check"></i><b>20</b> Naïve Bayes classifiers</a><ul>
<li class="chapter" data-level="20.1" data-path="naivebayes.html"><a href="naivebayes.html#the-naive-bayes-classifier"><i class="fa fa-check"></i><b>20.1</b> The Naive Bayes classifier</a></li>
<li class="chapter" data-level="20.2" data-path="naivebayes.html"><a href="naivebayes.html#a-crime-scene"><i class="fa fa-check"></i><b>20.2</b> A crime scene</a></li>
<li class="chapter" data-level="20.3" data-path="naivebayes.html"><a href="naivebayes.html#reconstructing-bayes-lawtheorem"><i class="fa fa-check"></i><b>20.3</b> Reconstructing Bayes law/theorem</a></li>
<li class="chapter" data-level="20.4" data-path="naivebayes.html"><a href="naivebayes.html#deciding-on-the-class"><i class="fa fa-check"></i><b>20.4</b> Deciding on the class</a></li>
<li class="chapter" data-level="20.5" data-path="naivebayes.html"><a href="naivebayes.html#continuous-predicting-variables"><i class="fa fa-check"></i><b>20.5</b> Continuous predicting variables</a></li>
<li class="chapter" data-level="20.6" data-path="naivebayes.html"><a href="naivebayes.html#combining-information-from-different-predictor-variables"><i class="fa fa-check"></i><b>20.6</b> Combining information from different predictor variables</a></li>
<li class="chapter" data-level="20.7" data-path="naivebayes.html"><a href="naivebayes.html#exercises-17"><i class="fa fa-check"></i><b>20.7</b> Exercises</a><ul>
<li class="chapter" data-level="20.7.1" data-path="naivebayes.html"><a href="naivebayes.html#predicting-iris-species"><i class="fa fa-check"></i><b>20.7.1</b> Predicting iris species</a></li>
<li class="chapter" data-level="20.7.2" data-path="naivebayes.html"><a href="naivebayes.html#predicting-income"><i class="fa fa-check"></i><b>20.7.2</b> Predicting income</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="resampling-techniques.html"><a href="resampling-techniques.html"><i class="fa fa-check"></i><b>21</b> Resampling techniques</a><ul>
<li class="chapter" data-level="21.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#bootstrapping"><i class="fa fa-check"></i><b>21.1</b> Bootstrapping</a></li>
<li class="chapter" data-level="21.2" data-path="resampling-techniques.html"><a href="resampling-techniques.html#exercises-18"><i class="fa fa-check"></i><b>21.2</b> Exercises</a><ul>
<li class="chapter" data-level="21.2.1" data-path="resampling-techniques.html"><a href="resampling-techniques.html#medical-patches"><i class="fa fa-check"></i><b>21.2.1</b> Medical patches</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="resampling-techniques.html"><a href="resampling-techniques.html#permutation-test"><i class="fa fa-check"></i><b>21.3</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html"><i class="fa fa-check"></i><b>22</b> Numerical differentiation and smoothing</a><ul>
<li class="chapter" data-level="22.1" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#exercises-19"><i class="fa fa-check"></i><b>22.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="randomnumbers.html"><a href="randomnumbers.html"><i class="fa fa-check"></i><b>23</b> Random numbers</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1">
<h1><span class="header-section-number">CHAPTER 5</span> Graphics</h1>
<p>The importance of intelligent and comprehensible graphical representation of data can not be overestimated. In the exploratory phase of data analysis it is often essential to get an impression of data quality, like bias, experimental error <em>etc</em>. but also of putative relations between variables that you might want to investigate. After analyzing data and hypothesis testing, a clear presentation of the evidence is important. A graph can be much more convincing than just a table with p-values. In contrast to tables of numbers, a good plot can be interpreted in a few seconds, and appeals to the “common sense” feeling of the reader. Perhaps even more importantly, graphs can show properties of data that are difficult to describe in a few words. An example, originating from the book “Introductory statistics with R” by <span class="citation">Dalgaard (<a href="#ref-Dalgaard2008">2008</a>)</span>, is shown below.</p>
<p>The amount of the vitamin folate was measured in red blood cells after incubation of the cells under different “ventilation” conditions: “N<sub>2</sub>O and O<sub>2</sub> for 24 hours”, “N<sub>2</sub>O and O<sub>2</sub> during operation”, and “only O<sub>2</sub> for 24 hours”. The question was whether there was a significant difference between any of the treatments, and if so, between which of the treatments. This question is typically solved by a one-way ANOVA (see Chapter <a href="linearmodels.html#linearmodels">12</a>). The outcome of this analysis (an F-test) showed that, indeed, there was a significant difference with p-value 0.044. To find out where the difference lies, a pairwise t-test with adjustment for multiple testing was performed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwise.t.test</span>(red.cell.folate<span class="op">$</span>folate, red.cell.folate<span class="op">$</span>ventilation)</code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  red.cell.folate$folate and red.cell.folate$ventilation 
## 
##           N2O+O2,24h N2O+O2,op
## N2O+O2,op 0.042      -        
## O2,24h    0.310      0.408    
## 
## P value adjustment method: holm</code></pre>
<p>This showed that the difference lies in the treatments “N<sub>2</sub>O and O<sub>2</sub> for 24 hours” and “N<sub>2</sub>O and O<sub>2</sub> during operation”. You might leave it with that, but the following graphical representation, a so-called boxplot, is quite illustrative of a weak spot in this analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(folate<span class="op">~</span>ventilation, <span class="dt">data=</span>red.cell.folate, <span class="dt">col=</span><span class="st">&#39;grey&#39;</span>, <span class="dt">las=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_03-1.png" width="672" /></p>
<p>Although it suggests that there might be a difference between the groups, it shows that the assumption implicitly underlying the previous ANOVA and t-tests, namely equal variance between the groups, is perhaps not justified. The hight of the boxes seems to differ! So, the tests have to be re-done without this assumption. The outcome of a pairwise t-test would then actually reject the alternative hypothesis!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwise.t.test</span>(red.cell.folate<span class="op">$</span>folate, red.cell.folate<span class="op">$</span>ventilation, <span class="dt">pool.sd=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with non-pooled SD 
## 
## data:  red.cell.folate$folate and red.cell.folate$ventilation 
## 
##           N2O+O2,24h N2O+O2,op
## N2O+O2,op 0.087      -        
## O2,24h    0.321      0.321    
## 
## P value adjustment method: holm</code></pre>
<p>To conclude, you have seen that a single well-chosen graph tells much more than p-values from a few statistical tests.</p>
<div id="the-basics-of-r-graphics" class="section level2">
<h2><span class="header-section-number">5.1</span> The basics of R graphics</h2>
<p>One of the great joys of R is its graphical capabilities. Many people use R to generate high-quality custom graphs for publication purposes, because of the incredible flexibility and high-quality output in the main graphical formats. You can control almost any aspect of graphical output. And often you don’t have to go into the details of graphical output, because many complex graph types can be created with single commands. Take a tour of the graphical capabilities by starting the demos and examples of a number of graphics packages and commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">demo</span>(graphics)
<span class="kw">demo</span>(image)
<span class="kw">demo</span>(persp)
<span class="kw">example</span>(plot)
<span class="kw">example</span>(pairs)
<span class="kw">example</span>(hist)</code></pre></div>
<p>Graphics are plotted in the figure window which floats independently from the other windows. Such a window is called a <em>graphical device</em>, and it is opened or refreshed automatically by the high-level plotting commands listed below. You can also launch one or more graphical windows manually by writing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">windows</span>()</code></pre></div>
<p>or the equivalent command on Mac and linux operating systems</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">X11</span>()</code></pre></div>
<p>This is convenient if you want to have multiple graphical windows on a screen, for example to compare plots. When you make a figure, it is plotted in a <em>graphical device</em>. As said, this can be a special window on your computer screen, but it can also be a file with a specific graphical format, like a PDF or JPEG file. A figure consists of a plot region surrounded by 4 margins, which are numbered clockwise, from 1 to 4, starting from the bottom. R distinguishes between:</p>
<ul>
<li><p><strong>high-level commands</strong>. By default, these create a new figure, <em>e.g.</em></p>
<ul>
<li><p><code>hist</code>, <code>barplot</code>, <code>pie</code>, <code>boxplot</code>, … (1-D plot)</p></li>
<li><p><code>plot</code>, <code>curve</code>, <code>matplot</code>, <code>pairs</code>, … ((x-y)plots)</p></li>
<li><p><code>image</code>, <code>contour</code>, <code>filled.contour</code>, … (2-D surface plots)</p></li>
<li><p><code>persp</code>, <code>scatterplot3d</code> (3-D plots)</p></li>
</ul></li>
<li><p><strong>low-level commands</strong> that add new objects to an existing figure, <em>e.g.</em></p>
<ul>
<li><p><code>lines</code>, <code>points</code>, <code>segments</code>, <code>polygon</code>, <code>rect</code>, <code>text</code>, <code>arrows</code>, <code>legend</code>, <code>abline</code>, <code>locator</code>, <code>rug</code>, … These add objects within the plot region</p></li>
<li><p><code>box</code>, <code>axis</code>, <code>mtext</code> (text in margin), <code>title</code>, … which add objects in the plot margin</p></li>
</ul></li>
<li><p><strong>graphical arguments</strong> that control the appearance of</p>
<ul>
<li><p>plotting objects: <code>cex</code> (size of text and symbols), <code>col</code> (colors), font, <code>las</code> (axis label orientation), <code>lty</code> (line type), <code>lwd</code> (line width), <code>pch</code> (the symbol type), …</p></li>
<li><p>graphic window: <code>mar</code> (the size of the margins), <code>mfrow</code> (the number of figures on a row), <code>mfcol</code>(number figures on a column), …</p></li>
</ul></li>
</ul>
<div class="handson">
<p>To obtain some idea of the possibilities you should look at the help files:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?plot.default
?par
?plot.window
?points</code></pre></div>
<p>or the examples (to go through the examples, press enter):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">example</span>(plot.default)
<span class="kw">example</span>(points)</code></pre></div>
</div>
</div>
<div id="x-y-plots" class="section level2">
<h2><span class="header-section-number">5.2</span> X-Y plots</h2>
<div class="figure"><span id="fig:iris"></span>
<img src="images/iris.png" alt="The three iris species from the iris dataset. Petals are the three smaller leafs in the flower, sepals are the three larger leafs. In many flowering plants sepals are green and support the flower leafs. In iris species they are coloured." width="771" />
<p class="caption">
Figure 5.1: The three iris species from the iris dataset. Petals are the three smaller leafs in the flower, sepals are the three larger leafs. In many flowering plants sepals are green and support the flower leafs. In iris species they are coloured.
</p>
</div>
<p>To demonstrate the different standard plot types, we will use the famous “iris” data set, which is available at start-up of R. It was introduced by the statistician Ronald A. Fisher. More information on this data set can be obtained from the help page: <code>?iris</code>. It gives measurements, in centimeters, for lengths and widths of sepals and petals of 50 flowers of each of the three species.</p>
<div class="handson">
<p>Type <code>head(iris)</code> to see the first 6 entries of the data frame. <code>?iris</code> gives a description of the data set (or see the Wikipedia Lemma with photographs of the iris species: <a href="http://en.wikipedia.org/wiki/Iris_flower_data_set" class="uri">http://en.wikipedia.org/wiki/Iris_flower_data_set</a>). Let us make an (x,y) plot of two of the four measured flower dimensions, namely <code>Petal.Length</code> and <code>Sepal.Length</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span>iris<span class="op">$</span>Petal.Length, <span class="dt">y=</span>iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_XY01-1.png" width="672" /></p>
</div>
<p>As <code>plot</code> is a high-level command, it starts a new figure. By default, R adds axes, and labels, and represents the (x,y) data as open circles. Although it is acceptable for data-gazing, you shouldn’t want to publish such a figure in a report or paper. We will change a few things by changing the default values of a number of arguments of the <code>plot()</code> function.</p>
<ul>
<li><p>Rather than open circles, the points should be something else (change function argument <code>pch</code>, for <strong>p</strong>oint <strong>ch</strong>aracter. See <code>example(points)</code> for a list of symbols).</p></li>
<li><p>The x- and y-axes labels should have proper text (change function arguments <code>xlab</code>, <code>ylab</code>)</p></li>
<li><p>The units of all measurements were cm. Hence, we may want the axes to have equal metrics, i.e. the <span class="math inline">\(x/y\)</span> aspect ratio should equal <span class="math inline">\(1\)</span> (function argument <code>asp</code>).</p></li>
</ul>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span>iris<span class="op">$</span>Petal.Length, <span class="dt">y=</span>iris<span class="op">$</span>Sepal.Length, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal length (cm)&quot;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_XY02-1.png" width="672" /></p>
</div>
<p>To this figure, we can now add <em>low-level</em> objects. Note that low-level commands only work on an open graphical device. For example, using linear regression, we have calculated that a straight line <span class="math inline">\(y=a+bx\)</span>, with <span class="math inline">\(a=4.31\)</span> and <span class="math inline">\(b=0.41\)</span> fits the data (we will learn later how to perform such a regression). We use the <code>lines()</code> function to draw a line, and we make it a red line (<code>col</code>) with line-width 2 (<code>lwd</code>):</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span>iris<span class="op">$</span>Petal.Length, <span class="dt">y=</span>iris<span class="op">$</span>Sepal.Length, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal length (cm)&quot;</span>)
<span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="fl">4.31</span><span class="op">+</span><span class="fl">0.41</span><span class="op">*</span><span class="dv">1</span>, <span class="fl">4.31</span><span class="op">+</span><span class="fl">0.41</span><span class="op">*</span><span class="dv">7</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_XY04-1.png" width="672" /></p>
</div>
<p>Now, we would also like to indicate the correspondence between iris species and the position in the graph, for example by using different symbol types or colors for the different species. This means that the plot symbol or color of the symbol should be made conditional on the <code>iris$Species</code> factor variable. For the application here, it is essential to realize again that factors are stored as integers (remember that the factor class is a subclass of the integer class), starting from <span class="math inline">\(1\)</span>. In the R-statement below, we simply use different symbols (<code>pch</code>) and colors (<code>col</code>) for each species: <code>pch=(15:17)[iris$Species]</code> means that, depending on the value of <code>iris$Species</code> (i.e. the species), the symbol (<code>pch</code>) will take on the value 1 (first species = setosa), 2 (second species = versicolor) and 3 (third species = virginica). <code>col=(1:3)[iris$Species]</code> does the same for the point color. The final statement adds a legend, positioned at the top left. See the reference card for a display of the available graphical symbols.</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span>iris<span class="op">$</span>Petal.Length, <span class="dt">y=</span>iris<span class="op">$</span>Sepal.Length, <span class="dt">pch=</span>(<span class="dv">15</span><span class="op">:</span><span class="dv">17</span>)[iris<span class="op">$</span>Species], <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal length (cm)&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>,<span class="st">&#39;blue&#39;</span>)[iris<span class="op">$</span>Species])
<span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="fl">4.31</span><span class="op">+</span><span class="fl">0.41</span><span class="op">*</span><span class="dv">1</span>, <span class="fl">4.31</span><span class="op">+</span><span class="fl">0.41</span><span class="op">*</span><span class="dv">7</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">legend</span>(<span class="fl">1.2</span>,<span class="dv">8</span>,<span class="dt">pch=</span><span class="dv">15</span><span class="op">:</span><span class="dv">17</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;green&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">legend=</span><span class="kw">levels</span>(iris<span class="op">$</span>Species))</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_XY05-1.png" width="672" /></p>
</div>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">5.3</span> Histograms</h2>
<p>Histograms are used to display distributions of variables. In R we can use the <code>hist()</code> function for making histograms. This function calculates by default a suitable, equally-spaced binning of the data, and calculates frequencies of the data per bin. Let us display the distribution of the iris petal length measurements, using the default settings:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h &lt;-<span class="st"> </span><span class="kw">hist</span>(iris<span class="op">$</span>Petal.Length, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_HI01-1.png" width="672" /></p>
</div>
<p>Note that we use the assignment function in this plotting statement. This is not necessary for generating the plot, but it allows us to examine and re-use the results of the binning calculations performed by the <code>hist()</code> function. The plot is a so-called “side-effect” of the <code>hist()</code> function. In fact, plots are always side-effects of some calculation, <em>i.e.</em> the output of plotting functions itself is always an R-object, although for many, like <code>plot()</code> this is just <code>NULL</code>, and its side-effect is actually its main purpose. To see the output of the <code>hist()</code> function in the calculation above, just type <code>h</code> in the console window and press return. The modifications to the default arguments you will most often make are a change in the number of bins (<code>nclass</code>), the variable displayed on the y-axis (either relative frequency or absolute counts), and perhaps the coloring or hatching (using the <code>density</code> argument, a confusing name I admit) of the bars. Like this:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">1</span>))
<span class="kw">hist</span>(iris<span class="op">$</span>Petal.Length, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">probability=</span><span class="ot">TRUE</span>)
<span class="kw">hist</span>(iris<span class="op">$</span>Petal.Length, <span class="dt">xlab=</span><span class="st">&quot;Petal length (cm)&quot;</span>, <span class="dt">density=</span><span class="dv">10</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">probability=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_HI02-1.png" width="80%" /></p>
</div>
<p>The <code>hist()</code> function has somewhat limited capabilities. It is, for example, not easy to overlay multiple histograms in one plot. If you need such capabilities it is better to use another graphical package, like the versatile graphical package “ggplot2” (see section <a href="graphics.html#graphical-systems">5.9</a>). In the first plot the bars for different species falling at the same position were stacked, and in the second they were or overlayed with semi-transparent colors. Side-by side of bars would have been another option (by setting the <code>position=&quot;dodge&quot;</code> parameter in the <code>geom_histogram()</code> function).</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># require(ggplot2)</span>
<span class="co"># Note that the &quot;multiplot&quot; function used below has to be defined by the user (you) first.</span>
<span class="co"># This function puts multiple ggplot functions in one graph. It can be obtained from</span>
<span class="co"># http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length, <span class="dt">fill=</span>Species))
p1 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>, <span class="dt">binwidth=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Petal length (cm)&quot;</span>)
p2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">position=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">binwidth=</span><span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.65</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Petal length (cm)&quot;</span>)
<span class="kw">multiplot</span>(p1, p2, <span class="dt">cols=</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<p><img src="StatR_files/figure-html/graphics_HI03_ggplot-1.png" width="80%" /></p>
</div>
</div>
<div id="boxplots" class="section level2">
<h2><span class="header-section-number">5.4</span> Boxplots</h2>
<p>Boxplots are used to plot continuous data as a function of categorical data. They are very useful in multivariate data analysis as you saw in the example at the beginning of this chapter, where a boxplot was used as a graphical support for a one-way ANOVA. Even if you decide not to publish the boxplot, it is always a good idea to use it for examining the data. For example, we could analyze the distribution of petal lengths in the three different iris species. We will use an R-formula in the <code>boxplot</code> function. The formula syntax is discussed in chapter <a href="formulasyntax.html#formulasyntax">10</a>. The R-formula <code>Petal.Length ~ Species</code> in the boxplot command can be interpreted as “(plot) the variable Petal.Length as a function of the variable Species”. We saw before that Petal.Length is a continuous variable and Species is a categorical variable, represented by a factor object in R:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(Petal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">col=</span><span class="st">&#39;grey&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Iris species&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Petal length&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_BP01-1.png" width="672" /></p>
</div>
<p>Based on this plot you might suspect that there is a significant difference between the petal lengths in the different species, a hypothesis that could be tested using a one-way ANOVA. However, you also notice from this plot that the variance of the petal length in the three species is probably different, a condition that is not compatible with a traditional ANOVA. You could now easily try some data transformations to find one that could meet the equal-variance condition. For example, a logarithmic transform of the petal lengths might be a good choice. We can simply modify the previous R-formula to make this plot:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(<span class="kw">log</span>(Petal.Length)<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">col=</span><span class="st">&#39;grey&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Iris species&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;log(Petal length)&#39;</span>)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_BP02-1.png" width="672" /></p>
</div>
<p>which looks already better from an “equal variance” perspective. You should read the help file of the <code>boxplot</code> command to know what the different graphical elements, like the whiskers and boxes in the boxplot represent, or how to change the default plot behavior.</p>
</div>
<div id="images-and-contour-plots" class="section level2">
<h2><span class="header-section-number">5.5</span> Images and contour plots</h2>
<p>R has some very nice functions to create images and contour plots. For example, the data set “Bathymetry” from the “marelac” package can be used to generate the bathymetry (and hypsometry) of the world oceans (and land). Before you run this example, you need to instal the “marelac” package.</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># require(marelac)</span>
<span class="kw">image</span>(Bathymetry<span class="op">$</span>x, Bathymetry<span class="op">$</span>y, Bathymetry<span class="op">$</span>z, <span class="dt">col=</span><span class="kw">femmecol</span>(<span class="dv">100</span>), <span class="dt">asp=</span><span class="ot">TRUE</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)
<span class="kw">contour</span>(Bathymetry<span class="op">$</span>x, Bathymetry<span class="op">$</span>y, Bathymetry<span class="op">$</span>z, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<p><img src="images/imageplotexample.png" width="70%" /></p>
<p>Note the use of <code>asp=TRUE</code>, which maintains the aspect ratio, meaning that x- and y- distances have the same scale on the graphic device.</p>
</div>
<div id="plotting-a-mathematical-function" class="section level2">
<h2><span class="header-section-number">5.6</span> Plotting a mathematical function</h2>
<p>Plot curves for mathematical functions are generated with R-command <code>curve</code>:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">sin</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x))</code></pre></div>
<p>will plot the curve for <span class="math inline">\(y=sin(3\pi x)\)</span>, using the default settings (figure left), while:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">sin</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x), <span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;f(x)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;curve&quot;</span>)
<span class="kw">curve</span>(<span class="kw">cos</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p>first draws a graph of <span class="math inline">\(y=sin(3\pi x)\)</span>, in blue (<code>col</code>), and for x values ranging between 0 and 2 (from, to), adding a main title (<code>main</code>) and x- and y-axis labels (<code>xlab</code>, <code>ylab</code>) (1st sentence). The 2nd R-sentence adds the function <span class="math inline">\(y=cos(3\pi x)\)</span>, as a red (<code>col</code>) dashed line (<code>lty</code>). Note the use of parameter <code>add=TRUE</code>, as by default curve creates a new plot. The final statements adds the x-axis, i.e. a horizontal, dashed (<code>lty=2</code>), line (<code>abline</code>) at <span class="math inline">\(y=0\)</span> and a legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;sin&quot;</span>,<span class="st">&quot;cos&quot;</span>),<span class="dt">text.col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre></div>
<p><img src="images/sinuses.png" width="90%" /></p>
</div>
</div>
<div id="multiple-figures-in-one-graphical-device" class="section level2">
<h2><span class="header-section-number">5.7</span> Multiple figures in one graphical device</h2>
<p>There are several ways in which to arrange multiple figures on a plot. The simplest is by specifying the number of figures on a row (<code>mfrow</code>) and on a column (<code>mfcol</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</code></pre></div>
<p>will arrange the next plots in 3 rows, 2 columns. Graphs will be plotted row-wise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</code></pre></div>
<p>will arrange the plots in 3 columns, 2 rows, in a column-wise sequence. Note that both <code>mfrow</code> and <code>mfcol</code> must be inputted as a vector. Try:</p>
<div class="handson">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="kw">curve</span>(<span class="kw">sin</span>(i<span class="op">*</span>pi<span class="op">*</span>x),<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">main=</span>i)</code></pre></div>
</div>
<p>The R-function <code>layout()</code> allows more complex plot arrangements.</p>
</div>
<div id="saving-graphs" class="section level2">
<h2><span class="header-section-number">5.8</span> Saving graphs</h2>
<p>Using the R console, you will obtain separate graphics windows when plotting a graph. When a graphics window is active (you have to click on it to become active) the main menu will look different. On the File menu there are options available for saving a graph in formats like PNG (portable network graphics), BMP (bitmap), JPEG (joint photographic experts group), PDF (portable document format) and others. Another option to save a graphic is to simply right mouse click on the graphic, which will produce a pop up menu with options to copy or save the graphic in a few formats as well as to directly print the graphic. In a Windows environment the copy options are as a bitmap or metafile, and the save options are as metafile or postscript. Remember that PDF and postscript formats are lossless, and as long as they do not contain bitmaps you can enlarge the figures without losing resolution. This is very convenient for posters and journal publications.</p>
<p>In Rstudio the plots as well as options to export them as pdf or images are available in the lower right “plots” panel.</p>
<p>If you want to save graphs for publication, and need full control over size, margins, fonts <em>etc</em>., it is a good idea to plot directly to a file instead of plotting on screen and then saving to file. The disadvantage is that if you plot directly to a file, the file itself is the graphical device, and you will not see the result on screen. However, you can play with some of the settings while plotting to screen first, and subsequently use these settings to plot to file. Note however, that many settings concerning size, font size <em>etc</em>. will not properly map on a screen graphical device. There are different types of file-based graphical devices for the different graphical formats, like PDF, BMP, PNG, JPEG and TIFF, invoked by commands like <code>pdf()</code>, <code>jpeg()</code>, <em>etc</em>. See the help file <code>?device</code> to obtain help on these different file-based graphical devices.</p>
</div>
<div id="graphical-systems" class="section level2">
<h2><span class="header-section-number">5.9</span> Different graphical systems and packages</h2>
<p>There are two basic graphical systems (implemented in standard packages) in R. The default system we have used above is encoded in the “graphics” package. The alternative system is encoded in the “grid” package. Since they are so fundamental, and form a basis for other graphical packages, we will refer to them as systems rather than packages. Both the “graphics” and “grid” system take care of the very basic drawing functions, like making a coordinate system, drawing lines, text, and points. These functions need to be called by other high-level plotting functions like <code>plot()</code>, <code>hist()</code>, <code>boxplot()</code>, <em>etc</em>. to be useful to an end-user. An end-user does not usually use graphics or grid functions directly. As an end-user, the only reason to know that there are two basic graphical systems in R is the fact that functions based on these packages can not be mixed in the same <em>graphical device</em> ( <em>i.e.</em> a graphical window on your computer, or a graphical file like a PDF, PNG, TIFF, or whatever format). In addition to the default graphical system and functions that we used above, two other packages are worth mentioning, namely the “lattice” and “ggplot2” packages. Both are based on the “grid” system, and hence cannot be mixed with traditional graphics. These packages enable substantial flexibility and complexity in producing graphs. My impression is that the recent “ggplot2” is one of the best innovations in graphical flexibility. For more literature on producing graphs, see <span class="citation">(Murrell <a href="#ref-Murrell2006">2006</a>)</span> (general basic graphics, grid and lattice), <span class="citation">(Sarkar <a href="#ref-Sarkar2008">2008</a>)</span> (by the author of the lattice package) and <span class="citation">(Wickham <a href="#ref-Wickham2009">2009</a>)</span> (by the author of the ggplot2 package). The author of ggplot2 has also set up a web manual with examples: <a href="http://docs.ggplot2.org" class="uri">http://docs.ggplot2.org</a>. A good recipe book for the ggplot2 package is <span class="citation">Chang (<a href="#ref-Chang2013">2012</a>)</span>.</p>
<p>Below I show three examples, including the R commands, of plotting the same data (“diamonds” from the ggplot2 package) with the default graphics package (<code>plot</code>), the lattice package (<code>xyplot</code>) and the ggplot2 package (<code>qplot</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(price<span class="op">~</span>carat, <span class="dt">data=</span>diamonds, <span class="dt">log=</span><span class="st">&#39;xy&#39;</span>, <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="kw">length</span>(<span class="kw">levels</span>(diamonds<span class="op">$</span>color)))[diamonds<span class="op">$</span>color])</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_28-1.jpeg" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># require(lattice)</span>
<span class="kw">xyplot</span>(price<span class="op">~</span>carat, <span class="dt">data=</span>diamonds, <span class="dt">scales=</span><span class="kw">list</span>(<span class="dt">x=</span><span class="kw">list</span>(<span class="dt">log=</span><span class="dv">10</span>),<span class="dt">y=</span><span class="kw">list</span>(<span class="dt">log=</span><span class="dv">10</span>)), <span class="dt">group=</span>color)</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_29-1.jpeg" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(carat, price, <span class="dt">data=</span>diamonds, <span class="dt">colour=</span>color) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<p><img src="StatR_files/figure-html/graphics_30-1.jpeg" width="2100" /></p>
<p>Finally, to see how easy it is to produce complex but intelligible graphs with ggplot2, we re-create the final plot of the iris data, this time including an on the fly fitted regression line:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>iris, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length, <span class="dt">y=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="co"># what to plot</span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">se=</span><span class="ot">FALSE</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># draw a fitted line through the data  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">shape=</span>Species, <span class="dt">color=</span>Species), <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="co"># plot points, adapt shape/color using Species variable</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>), <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="co"># where to put the legend</span></code></pre></div>
<p><img src="StatR_files/figure-html/graphics_31-1.png" width="672" /></p>
</div>
<div id="exercises-1" class="section level2">
<h2><span class="header-section-number">5.10</span> Exercises</h2>

<div id="simple-curves" class="section level3 unnumbered">
<h3>Simple curves</h3>
<ol style="list-style-type: decimal">
<li>Create a script that draws a curve of the function <span class="math inline">\(y=x^{3}\sin^{2}(3\pi x)\)</span>in the interval <span class="math inline">\([-2,2]\)</span>. Plot at a reasonable resolution (number of points) to obtain a smooth curve.
<div>
<a id="GraphicsHead1" href="javascript:toggle('GraphicsSol1','GraphicsHead1');" >Show solution</a>
</div>
<div id="GraphicsSol1" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {x<span class="op">^</span><span class="dv">3</span><span class="op">*</span>(<span class="kw">sin</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x)<span class="op">^</span><span class="dv">2</span>)}
<span class="kw">curve</span>(f, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">n=</span><span class="dv">200</span>)</code></pre></div>
</div></li>
<li>Make a curve of the function <span class="math inline">\(y=1/\cos(1+x^{2})\)</span> in the interval<span class="math inline">\([-5,5]\)</span>.
<div>
<a id="GraphicsHead2" href="javascript:toggle('GraphicsSol2','GraphicsHead2');" >Show solution</a>
</div>
<div id="GraphicsSol2" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="dv">1</span><span class="op">/</span>(<span class="kw">cos</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>))}
<span class="kw">curve</span>(f, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">n=</span><span class="dv">200</span>)</code></pre></div>
</div></li>
</ol>
</div>
<div id="human-population-growth" class="section level3 unnumbered">
<h3>Human population growth</h3>
<p>The human population (<span class="math inline">\(N\)</span>, millions of people) at a certain time <span class="math inline">\(t\)</span>, can be described as a function of time, the initial population density at <span class="math inline">\(t=t0\)</span> (<span class="math inline">\(N_{t0}\)</span>), the carrying capacity <span class="math inline">\(K\)</span> (maximum possible population) and the growth rate <span class="math inline">\(a\)</span> by the logistic growth equation:</p>
<p><span class="math display">\[
N(t)=\frac{K}{1+\left[\frac{K-N_{t0}}{N_{t0}}\right]\cdot e^{-a(t-t0)}}
\]</span></p>
<p>For the US, the population density in 1900 (<span class="math inline">\(N_{0}\)</span>) was 76.1 million people; the population growth can be described with parameter values: <span class="math inline">\(a\)</span>=0.02 yr<sup>-1</sup>, <span class="math inline">\(K\)</span>= 450 million. Actual population values were (in millions of people):</p>
<p><span class="math display">\[
\begin{array}{ccccccccc}
1900 &amp; 1910 &amp; 1920 &amp; 1930 &amp; 1940 &amp; 1950 &amp; 1960 &amp; 1970 &amp; 1980\\
76.1 &amp; 92.4 &amp; 106.5 &amp; 123.1 &amp; 132.6 &amp; 152.3 &amp; 180.7 &amp; 204.9 &amp; 226.5
\end{array}
\]</span></p>
<p>Tasks:</p>
<ol style="list-style-type: decimal">
<li>Plot the population density curve as a thick line, using the US parameter values (watch out with the units).
<div>
<a id="GraphicsHead3" href="javascript:toggle('GraphicsSol3','GraphicsHead3');" >Show solution</a>
</div>
<div id="GraphicsSol3" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="fl">0.02</span>
K &lt;-<span class="st"> </span><span class="dv">450</span>
N0 &lt;-<span class="st"> </span><span class="fl">76.1</span>
x0 &lt;-<span class="st"> </span><span class="dv">1900</span>
f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {K<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>((K<span class="op">-</span>N0)<span class="op">/</span>N0)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>a<span class="op">*</span>(x <span class="op">-</span><span class="st"> </span>x0)))}
<span class="kw">curve</span>(f, <span class="dv">1900</span>, <span class="dv">1980</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
</div></li>
<li>Add the measured population values as points. Finish the graph with titles, labels <em>etc</em>.
<div>
<a id="GraphicsHead4" href="javascript:toggle('GraphicsSol4','GraphicsHead4');" >Show solution</a>
</div>
<div id="GraphicsSol4" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="fl">0.02</span>
K &lt;-<span class="st"> </span><span class="dv">450</span>
N0 &lt;-<span class="st"> </span><span class="fl">76.1</span>
x0 &lt;-<span class="st"> </span><span class="dv">1900</span>
censusdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">year=</span><span class="kw">c</span>(<span class="dv">1900</span>, <span class="dv">1910</span>, <span class="dv">1920</span>, <span class="dv">1930</span>, <span class="dv">1940</span>, <span class="dv">1950</span>, <span class="dv">1960</span>, <span class="dv">1970</span>, <span class="dv">1980</span>),
  <span class="dt">population=</span><span class="kw">c</span>(<span class="fl">76.1</span>, <span class="fl">92.4</span>, <span class="fl">106.5</span>, <span class="fl">123.1</span>, <span class="fl">132.6</span>, <span class="fl">152.3</span>, <span class="fl">180.7</span>, <span class="fl">204.9</span>, <span class="fl">226.5</span>)
)
<span class="kw">plot</span>(population <span class="op">~</span><span class="st"> </span>year, <span class="dt">data=</span>censusdata)
<span class="kw">curve</span>(f, <span class="dv">1900</span>, <span class="dv">1980</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
</div></li>
</ol>
</div>
<div id="toxic-ammonia" class="section level3 unnumbered">
<h3>Toxic ammonia</h3>
<p>Nitrogen in the form of ammonia is present in two forms: the ammonium ion (<span class="math inline">\(NH_{4}^{+}\)</span>) and unionized ammonia (<span class="math inline">\(NH_{3}\)</span>). As ammonia can be toxic at sufficiently high levels, it is often desirable to know its concentration. The relative importance of ammonia, (the contribution of ammonia to total ammonia nitrogen, <span class="math inline">\(p_{[NH_{3}]}=[NH_{3}]/\left([NH_{3}]+[NH_{4}^{+}]\right)\)</span>) is a function of the proton concentration <span class="math inline">\([H^{+}]\)</span> and a parameter <span class="math inline">\(K_{N}\)</span>, the so-called stoichiometric equilibrium constant:</p>
<p><span class="math display">\[
p_{[NH_{3}]}=\frac{K_{N}}{K_{N}+[H^{+}]}
\]</span></p>
<p>Tasks:</p>
<ol style="list-style-type: decimal">
<li>Plot the relative fraction of toxic ammonia to the total ammonia concentration as a function of pH, where <span class="math inline">\(pH=-\log{}_{10}([H^{+}])\)</span> and for a temperature of 30°C. Use a range of pH from 5 to 11. The value of <span class="math inline">\(K_{N}\)</span> is 8x10<sup>-10</sup> at a temperature of 30°C.
<div>
<a id="GraphicsHead5" href="javascript:toggle('GraphicsSol5','GraphicsHead5');" >Show solution</a>
</div>
<div id="GraphicsSol5" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">KN &lt;-<span class="st"> </span><span class="fl">8E-10</span>
pNH &lt;-<span class="st"> </span><span class="cf">function</span>(x) {KN<span class="op">/</span>(KN <span class="op">+</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span>x))}
<span class="kw">curve</span>(pNH, <span class="dv">5</span>, <span class="dv">11</span>)</code></pre></div>
</div></li>
<li>Add to this plot the relative fraction of ammonia at 0°C; the value of <span class="math inline">\(K_{N}\)</span> at that temperature is 8x10<sup>-11</sup> mol/kg.
<div>
<a id="GraphicsHead6" href="javascript:toggle('GraphicsSol6','GraphicsHead6');" >Show solution</a>
</div>
<div id="GraphicsSol6" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">KN &lt;-<span class="st"> </span><span class="fl">8E-11</span>
<span class="kw">curve</span>(pNH, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
</div></li>
</ol>
</div>
<div id="the-iris-data-set" class="section level3 unnumbered">
<h3>The iris data set</h3>
<p>Have a look at the data:</p>
<ol style="list-style-type: decimal">
<li>What is the class of the data set? why?
<div>
<a id="GraphicsHead7" href="javascript:toggle('GraphicsSol7','GraphicsHead7');" >Show solution</a>
</div>
<div id="GraphicsSol7" style="display: none">
<p>It’s a data frame. A matrix would not have been suitable because there are both numerical and factor columns</p>
</div></li>
<li>What are the dimensions of the data set? (number of rows, columns)
<div>
<a id="GraphicsHead8" href="javascript:toggle('GraphicsSol8','GraphicsHead8');" >Show solution</a>
</div>
<div id="GraphicsSol8" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(iris)</code></pre></div>
<p>yields 150 rows and 5 columns</p>
</div></li>
<li>Produce a scatter plot of petal length against petal width; produce an informative title and labels of the two axes.
<div>
<a id="GraphicsHead9" href="javascript:toggle('GraphicsSol9','GraphicsHead9');" >Show solution</a>
</div>
<div id="GraphicsSol9" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Petal.Length<span class="op">~</span>Petal.Width, <span class="dt">data=</span>iris, <span class="dt">main=</span><span class="st">&#39;Two variables from the iris data set&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Petal width (cm)&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Petal length (cm)&#39;</span>)</code></pre></div>
<p>yields 150 rows and 5 columns</p>
</div></li>
<li>Repeat the same graph, using different symbol colors for the three species. (tip: make use of the fact that the Species column is a factor vector, which is internally represented by an integer vector)
<div>
<a id="GraphicsHead10" href="javascript:toggle('GraphicsSol10','GraphicsHead10');" >Show solution</a>
</div>
<div id="GraphicsSol10" style="display: none">
<p>See main text of this chapter</p>
</div></li>
<li>Add a legend to the graph. Copy the result to an Powerpoint, MS-Word or OpenOffice document.
<div>
<a id="GraphicsHead11" href="javascript:toggle('GraphicsSol11','GraphicsHead11');" >Show solution</a>
</div>
<div id="GraphicsSol11" style="display: none">
<p>See main text of this chapter</p>
</div></li>
<li>Create a box-and whisker plot for sepal length where the data values are split into species groups; use as template the first example in the <code>boxplot</code> help file.
<div>
<a id="GraphicsHead12" href="javascript:toggle('GraphicsSol12','GraphicsHead12');" >Show solution</a>
</div>
<div id="GraphicsSol12" style="display: none">
<p>See main text of this chapter</p>
</div></li>
<li>Now produce a similar box-and whisker plot for all four morphological measurements, arranged in two rows and two columns. Use the <code>layout()</code> function to first specify the graphical parameter that arranges the plots two by two.
<div>
<a id="GraphicsHead13" href="javascript:toggle('GraphicsSol13','GraphicsHead13');" >Show solution</a>
</div>
<div id="GraphicsSol13" style="display: none">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))
<span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris)
<span class="kw">boxplot</span>(Sepal.Width<span class="op">~</span>Species, <span class="dt">data=</span>iris)
<span class="kw">boxplot</span>(Petal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris)
<span class="kw">boxplot</span>(Petal.Width<span class="op">~</span>Species, <span class="dt">data=</span>iris)</code></pre></div>
</div></li>
</ol>
</div>
<div id="automatic-coercion-by-plot" class="section level3 unnumbered">
<h3>Automatic coercion by <code>plot()</code></h3>
<p>Create a data frame exactly as stated here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">nr=</span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;1&#39;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">20</span>)),<span class="dt">value=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)<span class="op">^</span><span class="dv">2</span>)</code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Check its content by printing <code>d</code> on the screen.</p></li>
<li><p>Now make a plot: <code>plot(d$nr, d$value)</code>. Something is going wrong here, because if you print <code>d$nr</code> and <code>d$value</code> to the screen they seem to be in the right order. Actually, the <code>plot(x,y)</code> command receives as its first argument a factor, which is not a number and it then tries to convert this to a numerical vector by applying <code>as.numeric()</code> to it. See what happens if you do that manually.</p></li>
<li><p>Use the coercion functions <code>as.character()</code> and <code>as.numeric()</code> to convert <code>d$nr</code> to the right numerical type vector, and make the plot.</p></li>
</ol>

<!---
Need to update: use readxl to rad from excel files directly
-->
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Dalgaard2008">
<p>Dalgaard, P. 2008. <em>Introductory Statistics with R</em>. 2nd ed. Statistics and Computing. New York, NY: Springer. doi:<a href="https://doi.org/10.1007/978-0-387-79054-1">10.1007/978-0-387-79054-1</a>.</p>
</div>
<div id="ref-Murrell2006">
<p>Murrell, P. 2006. <em>R Graphics</em>. Chapman &amp; Hall/CRC.</p>
</div>
<div id="ref-Sarkar2008">
<p>Sarkar, D. 2008. <em>Lattice: Multivariate Data Visualization with R</em>. New York: Springer. <a href="http://lmdvr.r-forge.r-project.org/" class="uri">http://lmdvr.r-forge.r-project.org/</a>.</p>
</div>
<div id="ref-Wickham2009">
<p>Wickham, H. 2009. <em>ggplot2. Elegant Graphics for Data Analysis</em>. New York, USA: Springer. doi:<a href="https://doi.org/10.1007/978-0-387-98141-3">10.1007/978-0-387-98141-3</a>.</p>
</div>
<div id="ref-Chang2013">
<p>Chang, W. 2012. <em>R Graphics Cookbook</em>. Edited by M. Loukides and C. Nash. 1st ed. O’Reilly. <a href="http://www.cookbook-r.com/Graphs" class="uri">http://www.cookbook-r.com/Graphs</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interacting-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="file-io.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "libs/mathjax-local/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
